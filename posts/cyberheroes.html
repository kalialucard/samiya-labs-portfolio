<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyberheroes | Technical Intelligence Labs</title>
    <link rel="stylesheet" href="../css/custom.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .markdown-content { font-family: 'Inter', sans-serif; line-height: 1.7; color: #cbd5e1; max-width: 100%; margin: 0 auto; padding-left: 2rem; border-left: 2px solid rgba(255, 255, 255, 0.1); position: relative; }
        .markdown-content h1 { font-size: 2.5rem; color: #fff; margin-bottom: 2rem; border-bottom: 1px solid #1e293b; padding-bottom: 1rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h1::before { content: ''; position: absolute; left: -2.35rem; top: 50%; width: 10px; height: 10px; background: #fff; border-radius: 50%; box-shadow: 0 0 10px #22c55e; border: 2px solid #0f172a; transform: translateY(-50%); }
        .markdown-content h2 { font-size: 1.75rem; color: #f8fafc; margin-top: 3rem; margin-bottom: 1rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h2::before { content: ''; position: absolute; left: -2.35rem; top: 50%; width: 8px; height: 8px; background: #22c55e; border-radius: 50%; transform: translateY(-50%); border: 2px solid #0f172a; }
        .markdown-content h3 { font-size: 1.25rem; color: #e2e8f0; margin-top: 2rem; margin-bottom: 0.75rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h3::before { content: ''; position: absolute; left: -2.3rem; top: 50%; width: 6px; height: 6px; background: #0ea5e9; border-radius: 50%; transform: translateY(-50%); border: 2px solid #0f172a; }
        .markdown-content code { background: #1e293b; color: #22c55e; padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-family: 'JetBrains Mono', monospace; }
        .markdown-content pre { background: #1e293b; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 2rem; border: 1px solid #334155; position: relative; }
        .markdown-content pre::before { content: "CODE_BLOCK"; position: absolute; top: 0; right: 0; background: #334155; color: #cbd5e1; font-size: 0.6rem; padding: 0.2rem 0.5rem; font-family: 'JetBrains Mono', monospace; border-bottom-left-radius: 0.5rem; }
        .markdown-content blockquote { 
            position: relative;
            border-left: 2px solid #22c55e; 
            padding: 1.5rem 0 1.5rem 1.75rem; 
            color: #cbd5e1; 
            margin-bottom: 2.5rem; 
            font-style: normal; 
            background: rgba(34, 197, 94, 0.03);
            border-radius: 0 4px 4px 0;
            box-shadow: inset 20px 0 20px -20px rgba(34, 197, 94, 0.15);
        }
        .markdown-content blockquote::before {
            content: "TECHNICAL_INTELLIGENCE";
            position: absolute;
            top: -9px;
            left: 0;
            background: #22c55e;
            color: #000;
            font-size: 0.6rem;
            font-weight: bold;
            padding: 2px 6px;
            font-family: 'JetBrains Mono', monospace;
        }
        .markdown-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1.5rem; }
        .markdown-content p { margin-bottom: 1.5rem; }
        
        .diag-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.05);
            padding: 1rem;
            font-family: 'JetBrains Mono', monospace;
            position: relative;
            overflow: hidden;
        }
        .diag-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 100%;
            background: #22c55e;
            opacity: 0.5;
        }
        .diag-label {
            display: block;
            font-size: 0.6rem;
            text-transform: uppercase;
            color: #64748b;
            margin-bottom: 0.25rem;
            letter-spacing: 0.1em;
        }
        .diag-value {
            font-size: 0.9rem;
            color: #cbd5e1;
        }
        .diag-blink {
            animation: blink 1s infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 antialiased selection:bg-accent-green selection:text-slate-900 flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-slate-900/90 backdrop-blur-md border-b border-slate-700">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <a href="../index.html" class="logo-container group flex items-center gap-3">
                 <img src="../images/logo.png" alt="Logo" class="h-10 w-auto group-hover:scale-105 transition-transform duration-300">
            </a>

            <div class="hidden lg:flex items-center gap-8 font-mono text-sm">
                <a href="../index.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Home</a>
                <a href="../about.html" class="text-slate-400 hover:text-accent-cyan transition-colors">About</a>
                <a href="../devhub.html" class="text-slate-400 hover:text-accent-cyan transition-colors">DevHub</a>
                <a href="../projects.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Projects</a>
                <a href="../writeups.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Write-ups</a>
                <a href="../certificates.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Certs</a>
                <a href="../contact.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Contact</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="py-20 px-6 max-w-4xl mx-auto flex-grow w-full">
        <!-- Post Header -->
        <header class="mb-12 border-b border-slate-800 pb-12">
            <div class="flex items-center gap-4 text-xs font-mono text-slate-500 mb-6 uppercase tracking-widest">
                <span class="px-2 py-1 bg-slate-900 border border-slate-800 rounded text-accent-green">tryhackme</span>
                <span>// 2024-12-30</span>
                <span>// ID: REF-Cyberheroes</span>
            </div>
            
            <h1 class="text-3xl md:text-5xl font-bold text-white mb-8 leading-tight font-mono">Cyberheroes</h1>
            
            <div class="flex flex-wrap gap-2">
                <!-- Tags populated by python -->
                <!-- web-exploitation, client-side-logic, javascript, hardcoded-credentials, directory-traversal, ctf, information-disclosure, credential-reversal -->
            </div>
        </header>

        <!-- Markdown Body -->
        <div class="markdown-content">
            <hr />
<p>This report documents the methodology employed to identify and exploit a vulnerability in a web application hosted at <code>10.201.62.16</code>. The core issue involved client-side credential verification with hardcoded, obfuscated credentials, leading to information disclosure and direct retrieval of a "flag" file.</p>
<h2>Reconnaissance &amp; Enumeration</h2>
<p>Initial reconnaissance identified a web server hosting a login page.</p>
<ul>
<li><strong>Service Discovery</strong>: A web server was accessible on the target IP address.</li>
<li><strong>Web Application Access</strong>: Browsing to <code>http://10.201.62.16/login.html</code> revealed a standard login form.</li>
</ul>
<p>Upon inspecting the <code>login.html</code> page using browser developer tools, client-side JavaScript responsible for authentication was identified. The relevant script, embedded directly within the HTML, contained the logic for credential validation.</p>
<h3>Relevant JavaScript Code</h3>
<p>The following JavaScript snippet was extracted from <code>login.html</code>:</p>
<pre class="codehilite"><code class="language-js">function authenticate() {
  a = document.getElementById('uname')
  b = document.getElementById('pass')
  const RevereString = str =&gt; [...str].reverse().join('');
  if (a.value==&quot;h3ck3rBoi&quot; &amp; b.value==RevereString(&quot;54321@terceSrepuS&quot;)) {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4 &amp;&amp; this.status == 200) {
        document.getElementById(&quot;flag&quot;).innerHTML = this.responseText ;
        document.getElementById(&quot;todel&quot;).innerHTML = &quot;&quot;;
        document.getElementById(&quot;rm&quot;).remove() ;
      }
    };
    xhttp.open(&quot;GET&quot;, &quot;RandomLo0o0o0o0o0o0o0o0o0o0gpath12345_Flag_&quot;+a.value+&quot;_&quot;+b.value+&quot;.txt&quot;, true);
    xhttp.send();
  }
  else {
    alert(&quot;Incorrect Password, try again.. you got this hacker !&quot;)
  }
}
</code></pre>

<h3>üîç Analysis</h3>
<p>The JavaScript code performs the following critical actions:</p>
<ul>
<li><strong>Hardcoded Username</strong>: The script explicitly checks for the username <code>h3ck3rBoi</code>.</li>
<li><strong>Obfuscated Password</strong>: The password comparison utilizes a helper function <code>RevereString</code> which reverses a string. The literal string <code>"54321@terceSrepuS"</code> is reversed and then compared against the user-supplied password.</li>
<li><strong>Flag File Generation</strong>: Upon successful authentication, an <code>XMLHttpRequest</code> is initiated to fetch a file. The filename is dynamically constructed using a static prefix, the username (<code>a.value</code>), and the password (<code>b.value</code>). The full path follows the pattern: <code>RandomLo0o0o0o0o0o0o0o0o0o0gpath12345_Flag_&lt;username&gt;_&lt;password&gt;.txt</code>.</li>
<li><strong>Client-Side Verification</strong>: The entire authentication logic, including sensitive credentials, resides client-side, making it susceptible to direct inspection and bypass.</li>
<li><strong>Operator Error</strong>: The script uses a single ampersand <code>&amp;</code> for a logical AND operation, which is typically <code>&amp;&amp;</code> in JavaScript. While it functions as intended in this context due to type coercion, it represents sloppy coding practice.</li>
</ul>
<h3>Derived Credentials</h3>
<p>Based on the script analysis, the credentials required for successful authentication are:</p>
<ul>
<li><strong>Username</strong>: <code>h3ck3rBoi</code></li>
<li><strong>Password</strong>: The reverse of <code>54321@terceSrepuS</code> which is <code>SuperSecret@12345</code></li>
</ul>
<h2>Exploitation</h2>
<p>Two primary methods were identified to retrieve the flag: direct file access and form submission. Direct file access is recommended due to its simplicity and circumvention of client-side rendering.</p>
<h3>Method 1: Direct File Retrieval (Recommended)</h3>
<p>Given the predictable filename constructed after successful client-side authentication, the "flag" file can be requested directly from the web server. Special characters in the password (e.g., <code>@</code>) must be URL-encoded (<code>%40</code>).</p>
<p><strong>Constructed Flag Filename (Raw):</strong><br />
<code>RandomLo0o0o0o0o0o0o0o0o0o0gpath12345_Flag_h3ck3rBoi_SuperSecret@12345.txt</code></p>
<p><strong>URL-Encoded Flag Filename:</strong><br />
<code>RandomLo0o0o0o0o0o0o0o0o0o0gpath12345_Flag_h3ck3rBoi_SuperSecret%4012345.txt</code></p>
<p><strong>Retrieval using <code>curl</code>:</strong></p>
<pre class="codehilite"><code class="language-bash">curl -s &quot;http://10.201.62.16/RandomLo0o0o0o0o0o0o0o0o0o0gpath12345_Flag_h3ck3rBoi_SuperSecret%4012345.txt&quot;
</code></pre>

<p><strong>Retrieval using a Web Browser:</strong><br />
Open the following URL in a browser while connected to the target network:</p>
<pre class="codehilite"><code>http://10.201.62.16/RandomLo0o0o0o0o0o0o0o0o0o0gpath12345_Flag_h3ck3rBoi_SuperSecret%4012345.txt
</code></pre>

<h3>üîç Analysis</h3>
<p>Executing the <code>curl</code> command or navigating to the URL directly will retrieve the contents of the flag file, assuming proper permissions and file existence on the web server. This method bypasses the client-side JavaScript entirely, relying only on the predictable path.</p>
<h3>Method 2: Login Form Submission (Alternate)</h3>
<p>The flag can also be obtained by interacting with the <code>login.html</code> form as intended by the developer.</p>
<ol>
<li>Navigate to <code>http://10.201.62.16/login.html</code> in a web browser.</li>
<li>Enter the derived credentials:<ul>
<li><strong>Username</strong>: <code>h3ck3rBoi</code></li>
<li><strong>Password</strong>: <code>SuperSecret@12345</code></li>
</ul>
</li>
<li>Submit the form. The client-side JavaScript will execute, fetch the flag via <code>XMLHttpRequest</code>, and display its contents within the HTML element with <code>id="flag"</code>.</li>
</ol>
<h2>Local Reproduction / Quick Commands</h2>
<p>To assist in replicating the string reversal or direct file access:</p>
<p><strong>String Reversal using <code>rev</code> (Linux/macOS):</strong></p>
<pre class="codehilite"><code class="language-bash">echo &quot;54321@terceSrepuS&quot; | rev
# Expected Output: SuperSecret@12345
</code></pre>

<p><strong>String Reversal using Python:</strong></p>
<pre class="codehilite"><code class="language-bash">python3 -c &quot;print('54321@terceSrepuS'[::-1])&quot;
# Expected Output: SuperSecret@12345
</code></pre>

<p><strong>Fetch the Flag File (Curl):</strong></p>
<pre class="codehilite"><code class="language-bash">curl -s &quot;http://10.201.62.16/RandomLo0o0o0o0o0o0o0o0o0o0gpath12345_Flag_h3ck3rBoi_SuperSecret%4012345.txt&quot;
</code></pre>

<h2>Conclusion &amp; Recommendations</h2>
<p>The primary vulnerability identified is the reliance on client-side logic for authentication and the hardcoding of sensitive credentials within publicly accessible JavaScript. This allowed for trivial extraction of the username and password, and subsequently, direct access to the intended "flag" file through a predictable URL path.</p>
<p><strong>Recommendations:</strong></p>
<ol>
<li><strong>Server-Side Authentication</strong>: Implement all authentication and authorization logic on the server-side.</li>
<li><strong>Secure Credential Management</strong>: Never hardcode credentials in client-side code or embed them in a way that can be easily reversed or observed.</li>
<li><strong>Dynamic File Naming</strong>: Avoid predictable naming conventions for sensitive files, especially when components like credentials are used in the filename.</li>
<li><strong>Input Validation &amp; Encoding</strong>: Ensure proper URL encoding is handled consistently on both client and server sides for any dynamic paths.</li>
<li><strong>Code Obfuscation (Limited Impact)</strong>: While code obfuscation can deter casual inspection, it is not a security control for determined attackers. The focus should be on server-side security.</li>
</ol>
<p><strong>Summary of Key Findings:</strong></p>
<ul>
<li><strong>Username</strong>: <code>h3ck3rBoi</code></li>
<li><strong>Password</strong>: <code>SuperSecret@12345</code></li>
<li><strong>Direct File Path (URL-encoded)</strong>: <code>RandomLo0o0o0o0o0o0o0o0o0o0gpath12345_Flag_h3ck3rBoi_SuperSecret%4012345.txt</code></li>
<li><strong>Exploitation Method</strong>: Direct HTTP GET request using <code>curl</code> or browser.</li>
</ul>
        </div>
    </main>

    <!-- Footer -->
    <footer class="py-16 text-center border-t border-slate-800 bg-transparent mt-24 relative overflow-hidden">
        <div class="max-w-7xl mx-auto px-6 grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
            <div class="diag-card text-left">
                <span class="diag-label">Access_Level</span>
                <span class="diag-value">OMNI_READ_ONLY</span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">Encryption</span>
                <span class="diag-value">AES-256-GCM<span class="diag-blink">_</span></span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">Signal_Strength</span>
                <span class="diag-value text-blue-400">PURE_DATA_STREAM</span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">System_Status</span>
                <span class="diag-value">STABLE_HARDENED</span>
            </div>
        </div>

        <div class="flex justify-center gap-6 mb-8">
            <a href="https://github.com/kalialucard" target="_blank"
                class="text-slate-400 hover:text-white transition-colors text-2xl" aria-label="GitHub"><i
                    class="fa-brands fa-github"></i></a>
            <a href="https://tryhackme.com/p/kalialucard" target="_blank"
                class="text-slate-400 hover:text-red-500 transition-colors text-2xl" aria-label="TryHackMe"
                title="TryHackMe"><i class="fa-solid fa-fire"></i></a>
            <a href="https://app.hackthebox.com/profile/2503089" target="_blank"
                class="text-slate-400 hover:text-green-400 transition-colors text-2xl" aria-label="HackTheBox"
                title="HackTheBox"><i class="fa-solid fa-cube"></i></a>
        </div>
        <p class="font-mono text-[10px] text-slate-600 uppercase tracking-widest text-center">Powered by kalialucard</p>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>